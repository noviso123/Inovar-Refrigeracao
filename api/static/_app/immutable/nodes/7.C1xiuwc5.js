import{c as G,a as i,f as M,s as j,t as ne}from"../chunks/DXVr3TX4.js";import{i as Ve}from"../chunks/CL5J6ee3.js";import{f as b,p as We,o as Ge,l as be,a as Ze,b as Je,g as e,m as V,c as a,s as r,d as U,n as A,r as t,t as B,u as $,i as Ke,e as Qe}from"../chunks/yKYHuomA.js";import{l as Z,b as J,i as ue}from"../chunks/01UUdhOg.js";import{I as K,c as Q,e as Re,i as Fe,b as Xe}from"../chunks/TgNKz3rK.js";import{B as je,C as W}from"../chunks/CMzhJ-sK.js";import{I as Se}from"../chunks/Ul1sdv7C.js";import{B as pe}from"../chunks/Ba5MWzQS.js";import{S as we}from"../chunks/Cw1zHoOm.js";import{D as Te,a as et}from"../chunks/LQrvHcrG.js";import{W as tt}from"../chunks/DOGTxiyn.js";import{F as at}from"../chunks/BToK9TmG.js";import{F as rt}from"../chunks/D2EUOuic.js";import{C as st}from"../chunks/C8yvqpl4.js";function ot(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"m7 7 10 10"}],["path",{d:"M17 7v10H7"}]];K(y,J({name:"arrow-down-right"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function nt(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"M7 7h10v10"}],["path",{d:"M7 17 17 7"}]];K(y,J({name:"arrow-up-right"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function it(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16"}],["path",{d:"M18 17V9"}],["path",{d:"M13 17V5"}],["path",{d:"M8 17v-3"}]];K(y,J({name:"chart-column"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function dt(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}]];K(y,J({name:"chart-pie"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function lt(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]];K(y,J({name:"circle-x"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function ct(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}],["path",{d:"M12 17.5v-11"}]];K(y,J({name:"receipt"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}function vt(y,u){const _=Z(u,["children","$$slots","$$events","$$legacy"]);const n=[["path",{d:"M16 7h6v6"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17"}]];K(y,J({name:"trending-up"},()=>_,{get iconNode(){return n},children:(c,E)=>{var l=G(),p=b(l);Q(p,u,"default",{}),i(c,l)},$$slots:{default:!0}}))}var ut=M("<!> Exportar Relatório",1),pt=M('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><!> <!></div>',1),ft=M('<div class="flex items-center justify-between mb-4"><div class="p-3 bg-white/20 rounded-2xl text-white"><!></div> <!></div> <p class="text-white/70 font-black text-xs uppercase tracking-widest">Receita Realizada</p> <p class="text-2xl font-black text-white mt-1"> </p>',1),_t=M('<div class="flex items-center justify-between mb-4"><div class="p-3 bg-blue-50 rounded-2xl text-blue-600"><!></div> <!></div> <p class="text-surface-400 font-black text-xs uppercase tracking-widest">A Receber</p> <p class="text-2xl font-black text-surface-900 mt-1"> </p>',1),gt=M('<div class="flex items-center justify-between mb-4"><div class="p-3 bg-yellow-50 rounded-2xl text-yellow-600"><!></div> <!></div> <p class="text-surface-400 font-black text-xs uppercase tracking-widest">Potencial Bruto</p> <p class="text-2xl font-black text-surface-900 mt-1"> </p>',1),mt=M('<div class="flex items-center justify-between mb-4"><div class="p-3 bg-red-50 rounded-2xl text-red-600"><!></div> <!></div> <p class="text-surface-400 font-black text-xs uppercase tracking-widest">Receita Perdida</p> <p class="text-2xl font-black text-surface-900 mt-1"> </p>',1),xt=M('<div class="grid grid-cols-2 gap-4 animate-in slide-in-from-top-2"><!> <!></div>'),ht=M('<div class="flex items-center gap-4 mb-8"><div class="p-3 bg-brand-50 rounded-2xl text-brand-600"><!></div> <div><h2 class="text-xl font-black text-surface-900 tracking-tight">Filtros</h2> <p class="text-surface-500 font-bold text-sm">Refine o período do relatório</p></div></div> <div class="space-y-6"><div class="space-y-2"><label class="text-xs font-black uppercase tracking-widest text-surface-500 ml-1">Período</label> <select class="w-full h-12 px-4 bg-surface-50 border border-surface-200 rounded-xl font-bold text-surface-900 outline-none focus:border-brand-500 transition-all appearance-none"><option>Este Mês</option><option>Este Ano</option><option>Personalizado</option></select></div> <!> <div class="pt-4 space-y-4"><div class="p-6 bg-surface-50 rounded-[2rem] border border-surface-100"><div class="flex items-center justify-between mb-4"><p class="text-sm font-black text-surface-500 uppercase tracking-widest">Notas Fiscais</p> <!></div> <div class="space-y-3"><div class="flex justify-between items-center"><span class="text-sm font-bold text-surface-600">Emitidas</span> <!></div> <div class="flex justify-between items-center"><span class="text-sm font-bold text-surface-600">Pendentes</span> <!></div></div></div></div></div>',1),$t=M(`<div class="flex items-center gap-4 mb-6"><div class="p-3 bg-white/20 rounded-2xl"><!></div> <h3 class="text-xl font-black tracking-tight">Dica Financeira</h3></div> <p class="font-bold text-brand-100 opacity-90 leading-relaxed">Mantenha suas ordens de serviço atualizadas para
                            garantir que as métricas de faturamento reflitam a
                            realidade do seu negócio.</p>`,1),bt=M('<div class="p-8 hover:bg-surface-50 transition-colors group"><div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4"><div class="space-y-1"><div class="flex items-center gap-3"><span class="text-xs font-black text-brand-600 uppercase tracking-widest"> </span> <!></div> <h4 class="text-lg font-black text-surface-900 group-hover:text-brand-700 transition-colors"> </h4> <p class="text-sm font-bold text-surface-500"> </p></div> <div class="text-right w-full md:w-auto"><p class="text-2xl font-black text-surface-900"> </p> <p class="text-xs font-black text-surface-400 uppercase tracking-widest mt-1"> </p></div></div></div>'),wt=M(`<div class="p-20 text-center"><!> <p class="text-surface-500 font-bold">Nenhuma movimentação financeira
                                        encontrada para este período.</p></div>`),yt=M('<div class="p-6 bg-surface-50 border-t border-surface-100 text-center"><!></div>'),kt=M('<div class="px-8 py-6 border-b border-surface-100 bg-surface-50 flex items-center justify-between"><h3 class="text-xl font-black text-surface-900 tracking-tight">Extrato de Movimentações</h3> <!></div> <div class="divide-y divide-surface-100"><!> <!></div> <!>',1),Nt=M('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"><!> <!> <!> <!></div> <div class="grid grid-cols-1 lg:grid-cols-12 gap-8"><div class="lg:col-span-4 space-y-8"><!> <!></div> <div class="lg:col-span-8"><!></div></div>',1),Mt=M('<div class="min-h-screen bg-surface-50 pb-24"><div class="bg-white border-b border-surface-200 px-4 py-8"><div class="max-w-7xl mx-auto flex flex-col md:flex-row md:items-center justify-between gap-6"><div><h1 class="text-4xl font-black text-surface-900 tracking-tight flex items-center gap-3"><!> Financeiro</h1> <p class="text-surface-500 font-bold mt-2">Gestão de fluxo de caixa, faturamento e métricas de receita</p></div> <!></div></div> <div class="max-w-7xl mx-auto px-4 py-8 space-y-8"><!></div></div>');function It(y,u){We(u,!1);const _=V(),n=V(),c=V();let E=[],l=V(!0),p=V("MONTHLY"),ie=V(""),de=V("");async function Ae(){U(l,!0);try{const s=localStorage.getItem("token"),g=await fetch("/api/solicitacoes",{headers:{Authorization:`Bearer ${s}`}});g.ok&&(E=await g.json())}catch(s){console.error("Erro ao carregar:",s)}finally{U(l,!1)}}function ye(){const s=new Date,g=s.getMonth(),x=s.getFullYear();return E.filter(P=>{const m=new Date(P.created_at);if(isNaN(m.getTime()))return!1;if(e(p)==="MONTHLY")return m.getMonth()===g&&m.getFullYear()===x;if(e(p)==="ANNUAL")return m.getFullYear()===x;if(e(p)==="CUSTOM"){if(!e(ie)||!e(de))return!0;const k=new Date(e(ie)),w=new Date(e(de));return w.setHours(23,59,59,999),m>=k&&m<=w}return!1})}function te(s){return s.toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2})}function ke(s){return new Date(s).toLocaleDateString("pt-BR")}function Le(){const s=ye();if(s.length===0){alert("Nenhum registro encontrado para o período.");return}const g=["Data,OS,Cliente,Status,Valor"];s.forEach(k=>{g.push(`${ke(k.created_at)},#${k.sequential_id},${k.cliente?.nome||"-"},${k.status},${k.valor_total||0}`)});const x=new Blob([g.join(`
`)],{type:"text/csv;charset=utf-8;"}),P=URL.createObjectURL(x),m=document.createElement("a");m.href=P,m.download=`relatorio_financeiro_${new Date().toISOString().split("T")[0]}.csv`,m.click()}Ge(()=>{Ae()}),be(()=>{},()=>{U(_,ye())}),be(()=>e(_),()=>{U(n,(()=>{let s=0,g=0,x=0,P=0,m=0,k=0;return e(_).forEach(w=>{const q=w.valor_total||0;w.status==="faturado"||w.status==="concluido"?(s+=q,w.status==="concluido"&&!w.nfse?.numero&&k++):["aprovado","em_andamento"].includes(w.status)?g+=q:["orcamento","pendente"].includes(w.status)?x+=q:w.status==="cancelado"&&(P+=q),w.nfse?.numero&&m++}),{revenue:s,pending:g,potential:x,lost:P,issuedCount:m,pendingCount:k}})())}),be(()=>e(_),()=>{U(c,e(_).filter(s=>(s.valor_total||0)>0).sort((s,g)=>new Date(g.created_at).getTime()-new Date(s.created_at).getTime()))}),Ze(),Ve();var fe=Mt(),_e=a(fe),Ne=a(_e),ge=a(Ne),Me=a(ge),Be=a(Me);Te(Be,{class:"w-10 h-10 text-brand-600"}),A(),t(Me),A(2),t(ge);var Ee=r(ge,2);je(Ee,{variant:"primary",size:"lg",className:"shadow-xl shadow-brand-500/20",$$events:{click:Le},children:(s,g)=>{var x=ut(),P=b(x);et(P,{class:"w-5 h-5 mr-2"}),A(),i(s,x)},$$slots:{default:!0}}),t(Ne),t(_e);var Pe=r(_e,2),Oe=a(Pe);{var qe=s=>{var g=pt(),x=b(g);Re(x,4,()=>Array(4),Fe,(w,q)=>{we(w,{className:"h-32 rounded-[2rem]"})}),t(x);var P=r(x,2),m=a(P);we(m,{className:"h-[400px] rounded-[3rem]"});var k=r(m,2);we(k,{className:"h-[400px] rounded-[3rem]"}),t(P),i(s,g)},Ie=s=>{var g=Nt(),x=b(g),P=a(x);W(P,{padding:"p-6",className:"bg-gradient-to-br from-green-500 to-green-600 border-none shadow-xl shadow-green-500/20",children:(C,X)=>{var f=ft(),d=b(f),v=a(d),N=a(v);vt(N,{class:"w-6 h-6"}),t(v);var z=r(v,2);nt(z,{class:"w-5 h-5 text-white/50"}),t(d);var h=r(d,4),R=a(h,!0);t(h),B(F=>j(R,F),[()=>(e(n),$(()=>te(e(n).revenue)))]),i(C,f)},$$slots:{default:!0}});var m=r(P,2);W(m,{padding:"p-6",className:"bg-white border-surface-200 shadow-sm",children:(C,X)=>{var f=_t(),d=b(f),v=a(d),N=a(v);tt(N,{class:"w-6 h-6"}),t(v);var z=r(v,2);it(z,{class:"w-5 h-5 text-surface-300"}),t(d);var h=r(d,4),R=a(h,!0);t(h),B(F=>j(R,F),[()=>(e(n),$(()=>te(e(n).pending)))]),i(C,f)},$$slots:{default:!0}});var k=r(m,2);W(k,{padding:"p-6",className:"bg-white border-surface-200 shadow-sm",children:(C,X)=>{var f=gt(),d=b(f),v=a(d),N=a(v);ct(N,{class:"w-6 h-6"}),t(v);var z=r(v,2);dt(z,{class:"w-5 h-5 text-surface-300"}),t(d);var h=r(d,4),R=a(h,!0);t(h),B(F=>j(R,F),[()=>(e(n),$(()=>te(e(n).potential)))]),i(C,f)},$$slots:{default:!0}});var w=r(k,2);W(w,{padding:"p-6",className:"bg-white border-surface-200 shadow-sm",children:(C,X)=>{var f=mt(),d=b(f),v=a(d),N=a(v);lt(N,{class:"w-6 h-6"}),t(v);var z=r(v,2);ot(z,{class:"w-5 h-5 text-surface-300"}),t(d);var h=r(d,4),R=a(h,!0);t(h),B(F=>j(R,F),[()=>(e(n),$(()=>te(e(n).lost)))]),i(C,f)},$$slots:{default:!0}}),t(x);var q=r(x,2),me=a(q),De=a(me);W(De,{padding:"p-8",children:(C,X)=>{var f=ht(),d=b(f),v=a(d),N=a(v);at(N,{class:"w-6 h-6"}),t(v),A(2),t(d);var z=r(d,2),h=a(z),R=r(a(h),2);B(()=>{e(p),Ke(()=>{})});var F=a(R);F.value=F.__value="MONTHLY";var ae=r(F);ae.value=ae.__value="ANNUAL";var D=r(ae);D.value=D.__value="CUSTOM",t(R),t(h);var o=r(h,2);{var S=L=>{var I=xt(),T=a(I);Se(T,{label:"Início",type:"date",get value(){return e(ie)},set value(ee){U(ie,ee)},$$legacy:!0});var xe=r(T,2);Se(xe,{label:"Fim",type:"date",get value(){return e(de)},set value(ee){U(de,ee)},$$legacy:!0}),t(I),i(L,I)};ue(o,L=>{e(p)==="CUSTOM"&&L(S)})}var Y=r(o,2),H=a(Y),O=a(H),re=r(a(O),2);rt(re,{class:"w-5 h-5 text-brand-500"}),t(O);var le=r(O,2),se=a(le),oe=r(a(se),2);pe(oe,{variant:"success",children:(L,I)=>{A();var T=ne();B(()=>j(T,(e(n),$(()=>e(n).issuedCount)))),i(L,T)},$$slots:{default:!0}}),t(se);var ce=r(se,2),ve=r(a(ce),2);pe(ve,{variant:"warning",children:(L,I)=>{A();var T=ne();B(()=>j(T,(e(n),$(()=>e(n).pendingCount)))),i(L,T)},$$slots:{default:!0}}),t(ce),t(le),t(H),t(Y),t(z),Xe(R,()=>e(p),L=>U(p,L)),i(C,f)},$$slots:{default:!0}});var Ue=r(De,2);W(Ue,{padding:"p-8",className:"bg-brand-600 text-white border-none",children:(C,X)=>{var f=$t(),d=b(f),v=a(d),N=a(v);st(N,{class:"w-6 h-6"}),t(v),A(2),t(d),A(2),i(C,f)},$$slots:{default:!0}}),t(me);var Ce=r(me,2),Ye=a(Ce);W(Ye,{padding:"p-0",className:"overflow-hidden",children:(C,X)=>{var f=kt(),d=b(f),v=r(a(d),2);pe(v,{variant:"neutral",children:(D,o)=>{A();var S=ne();B(()=>j(S,`${e(c),$(()=>e(c).length)??""} registros`)),i(D,S)},$$slots:{default:!0}}),t(d);var N=r(d,2),z=a(N);Re(z,1,()=>(e(c),$(()=>e(c).slice(0,20))),Fe,(D,o)=>{var S=bt(),Y=a(S),H=a(Y),O=a(H),re=a(O),le=a(re);t(re);var se=r(re,2);{let he=Qe(()=>(e(o),$(()=>e(o).status==="faturado"||e(o).status==="concluido"?"success":e(o).status==="cancelado"?"danger":"neutral")));pe(se,{get variant(){return e(he)},size:"sm",children:($e,Pt)=>{A();var ze=ne();B(()=>j(ze,(e(o),$(()=>e(o).status)))),i($e,ze)},$$slots:{default:!0}})}t(O);var oe=r(O,2),ce=a(oe,!0);t(oe);var ve=r(oe,2),L=a(ve,!0);t(ve),t(H);var I=r(H,2),T=a(I),xe=a(T,!0);t(T);var ee=r(T,2),He=a(ee,!0);t(ee),t(I),t(Y),t(S),B((he,$e)=>{j(le,`#${e(o),$(()=>e(o).sequential_id)??""}`),j(ce,(e(o),$(()=>e(o).titulo))),j(L,(e(o),$(()=>e(o).cliente?.nome||"-"))),j(xe,he),j(He,$e)},[()=>(e(o),$(()=>te(e(o).valor_total||0))),()=>(e(o),$(()=>ke(e(o).created_at)))]),i(D,S)});var h=r(z,2);{var R=D=>{var o=wt(),S=a(o);Te(S,{class:"w-12 h-12 text-surface-200 mx-auto mb-4"}),A(2),t(o),i(D,o)};ue(h,D=>{e(c),$(()=>e(c).length===0)&&D(R)})}t(N);var F=r(N,2);{var ae=D=>{var o=yt(),S=a(o);je(S,{variant:"ghost",size:"sm",className:"font-black uppercase tracking-widest text-xs",children:(Y,H)=>{A();var O=ne("Ver todas as transações");i(Y,O)},$$slots:{default:!0}}),t(o),i(D,o)};ue(F,D=>{e(c),$(()=>e(c).length>20)&&D(ae)})}i(C,f)},$$slots:{default:!0}}),t(Ce),t(q),i(s,g)};ue(Oe,s=>{e(l)?s(qe):s(Ie,!1)})}t(Pe),t(fe),i(y,fe),Je()}export{It as component};
