import{c as Ve,a as n,f,t as ne,e as be,s as F}from"../chunks/DXVr3TX4.js";import{i as He}from"../chunks/CL5J6ee3.js";import{f as E,p as Ke,o as Qe,b as Re,c as a,s,d as c,h as q,g as r,m as j,e as we,t as ye,n as v,r as e}from"../chunks/yKYHuomA.js";import{l as Xe,b as Ye,i as V,s as Ze,a as ea}from"../chunks/01UUdhOg.js";import{I as aa,c as ra,s as ke,e as Pe,i as Se}from"../chunks/TgNKz3rK.js";import{u as sa}from"../chunks/ZiicVdhW.js";import{B,C as Ne}from"../chunks/CMzhJ-sK.js";import{I as ce}from"../chunks/Ul1sdv7C.js";import{B as Ue}from"../chunks/Ba5MWzQS.js";import{M as ta}from"../chunks/CaCDDUcm.js";import{S as G}from"../chunks/Cw1zHoOm.js";import{U as oa}from"../chunks/C2dVUy_s.js";import{P as la}from"../chunks/CnIMmsLf.js";import{U as Ae}from"../chunks/B2Nmx6HV.js";import{L as ia}from"../chunks/5Qq1Lhg_.js";import{S as Ce}from"../chunks/ofbBDwVA.js";import{S as da}from"../chunks/CAPDtyWD.js";import{M as na}from"../chunks/HN8t3Ydv.js";import{C as ca}from"../chunks/BUY1kFW0.js";import{T as va}from"../chunks/B4UXOIAF.js";function pa(H,J){const K=Xe(J,["children","$$slots","$$events","$$legacy"]);const Q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}]];aa(H,Ye({name:"shield"},()=>K,{get iconNode(){return Q},children:(R,X)=>{var M=Ve(),h=E(M);ra(h,J,"default",{}),n(R,M)},$$slots:{default:!0}}))}var ma=f("<!> Novo Usuário",1),fa=f('<div class="flex items-center gap-4 mb-6"><!> <div class="flex-1 space-y-2"><!> <!></div></div> <div class="space-y-3"><!> <!></div>',1),ua=f('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),_a=f("<!> Admin",1),ga=f('<div class="w-2 h-2 rounded-full bg-green-500" title="Ativo"></div>'),ha=f('<div class="w-2 h-2 rounded-full bg-surface-300" title="Inativo"></div>'),xa=f("Gerenciar Acesso <!>",1),$a=f('<div class="flex items-start justify-between mb-6"><div class="flex items-center gap-4"><div class="w-14 h-14 rounded-2xl bg-brand-50 text-brand-600 flex items-center justify-center font-black text-2xl group-hover:bg-brand-600 group-hover:text-white transition-all duration-300"> </div> <div class="min-w-0"><h3 class="font-black text-surface-900 group-hover:text-brand-700 transition-colors"> </h3> <div class="flex items-center gap-2 mt-1"><!> <!></div></div></div> <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity"><!> <!></div></div> <div class="space-y-4"><div class="flex items-center gap-3 text-sm font-bold text-surface-500"><div class="w-8 h-8 rounded-lg bg-surface-50 flex items-center justify-center text-surface-400"><!></div> <span class="truncate"> </span></div> <div class="flex items-center gap-3 text-sm font-bold text-surface-500"><div class="w-8 h-8 rounded-lg bg-surface-50 flex items-center justify-center text-surface-400"><!></div> <span> </span></div></div> <div class="mt-8 pt-6 border-t border-surface-100"><!></div>',1),ba=f('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),wa=f('<div class="space-y-8 py-4"><div class="space-y-6"><h4 class="text-xs font-black text-surface-400 uppercase tracking-widest flex items-center gap-2"><!> Informações Pessoais</h4> <div class="space-y-4"><!> <!></div></div> <div class="space-y-6"><h4 class="text-xs font-black text-surface-400 uppercase tracking-widest flex items-center gap-2"><!> Permissões e Segurança</h4> <div class="space-y-6"><div class="space-y-2"><label class="text-xs font-black uppercase tracking-widest text-surface-500 ml-1">Cargo / Nível de Acesso</label> <div class="grid grid-cols-2 gap-4"><button><!> <span class="font-black text-sm">Prestador</span></button> <button><!> <span class="font-black text-sm">Administrador</span></button></div></div> <!></div></div> <div class="pt-6 flex gap-4"><!> <!></div></div>'),ya=f('<div class="min-h-screen bg-surface-50 pb-24"><div class="bg-white border-b border-surface-200 px-4 py-8"><div class="max-w-7xl mx-auto flex flex-col md:flex-row md:items-center justify-between gap-6"><div><h1 class="text-4xl font-black text-surface-900 tracking-tight flex items-center gap-3"><!> Usuários</h1> <p class="text-surface-500 font-bold mt-2">Gerencie os acessos e permissões dos colaboradores</p></div> <!></div></div> <div class="max-w-7xl mx-auto px-4 py-8"><!></div></div> <!>',1);function Ja(H,J){Ke(J,!1);const K=()=>ea(sa,"$currentUser",Q),[Q,R]=Ze();let X=j([]),M=j(!0),h=j(!1),k=j(null),Y=j(!1),i=j({email:"",nome_completo:"",cargo:"prestador",password:""});async function Z(){try{const t=localStorage.getItem("token"),l=await fetch("/api/usuarios",{headers:{Authorization:`Bearer ${t}`}});l.ok&&c(X,await l.json())}catch(t){console.error("Erro ao carregar usuários:",t)}finally{c(M,!1)}}async function Ee(){c(Y,!0);try{const t=localStorage.getItem("token"),l=r(k)?"PUT":"POST",_=r(k)?`/api/usuarios/${r(k).id}`:"/api/usuarios";(await fetch(_,{method:l,headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(r(i))})).ok&&(c(h,!1),ve(),await Z())}catch(t){console.error("Erro ao salvar:",t)}finally{c(Y,!1)}}async function ze(t){if(confirm("Excluir este usuário?"))try{const l=localStorage.getItem("token");await fetch(`/api/usuarios/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}}),await Z()}catch(l){console.error("Erro ao excluir:",l)}}function ve(){c(i,{email:"",nome_completo:"",cargo:"prestador",password:""}),c(k,null)}function pe(t){c(k,t),c(i,{email:t.email,nome_completo:t.nome_completo,cargo:t.cargo,password:""}),c(h,!0)}function Ie(){ve(),c(h,!0)}Qe(()=>{Z()}),He();var me=ya(),ee=E(me),ae=a(ee),fe=a(ae),re=a(fe),ue=a(re),je=a(ue);oa(je,{class:"w-10 h-10 text-brand-600"}),v(),e(ue),v(2),e(re);var Be=s(re,2);B(Be,{variant:"primary",size:"lg",className:"shadow-xl shadow-brand-500/20",$$events:{click:Ie},children:(t,l)=>{var _=ma(),d=E(_);la(d,{class:"w-5 h-5 mr-2"}),v(),n(t,_)},$$slots:{default:!0}}),e(fe),e(ae);var _e=s(ae,2),Me=a(_e);{var Te=t=>{var l=ua();Pe(l,4,()=>Array(6),Se,(_,d)=>{Ne(_,{padding:"p-6",children:(P,T)=>{var S=fa(),u=E(S),g=a(u);G(g,{className:"w-14 h-14 rounded-2xl"});var x=s(g,2),$=a(x);G($,{className:"w-3/4 h-5"});var b=s($,2);G(b,{className:"w-1/2 h-3"}),e(x),e(u);var w=s(u,2),N=a(w);G(N,{className:"w-full h-4"});var y=s(N,2);G(y,{className:"w-full h-4"}),e(w),n(P,S)},$$slots:{default:!0}})}),e(l),n(t,l)},Oe=t=>{var l=ba();Pe(l,5,()=>r(X),Se,(_,d)=>{Ne(_,{padding:"p-6",className:"group hover:border-brand-500 hover:shadow-2xl hover:shadow-brand-500/10 transition-all duration-300",children:(P,T)=>{var S=$a(),u=E(S),g=a(u),x=a(g),$=a(x,!0);e(x);var b=s(x,2),w=a(b),N=a(w,!0);e(w);var y=s(w,2),O=a(y);{var U=o=>{Ue(o,{variant:"brand",size:"sm",children:(m,W)=>{var I=_a(),Fe=E(I);Ce(Fe,{class:"w-3 h-3 mr-1"}),v(),n(m,I)},$$slots:{default:!0}})},se=o=>{Ue(o,{variant:"neutral",size:"sm",children:(m,W)=>{v();var I=ne("Prestador");n(m,I)},$$slots:{default:!0}})};V(O,o=>{r(d).cargo==="admin"?o(U):o(se,!1)})}var z=s(O,2);{var te=o=>{var m=ga();n(o,m)},oe=o=>{var m=ha();n(o,m)};V(z,o=>{r(d).is_active?o(te):o(oe,!1)})}e(y),e(b),e(g);var D=s(g,2),L=a(D);B(L,{variant:"ghost",size:"sm",className:"p-2",$$events:{click:()=>pe(r(d))},children:(o,m)=>{da(o,{class:"w-4 h-4"})},$$slots:{default:!0}});var le=s(L,2);{var p=o=>{B(o,{variant:"ghost",size:"sm",className:"p-2 text-red-500 hover:bg-red-50",$$events:{click:()=>ze(r(d).id)},children:(m,W)=>{va(m,{class:"w-4 h-4"})},$$slots:{default:!0}})};V(le,o=>{r(d).id!==K()?.id&&o(p)})}e(D),e(u);var A=s(u,2),C=a(A),ie=a(C),Le=a(ie);na(Le,{class:"w-4 h-4"}),e(ie);var ge=s(ie,2),We=a(ge,!0);e(ge),e(C);var he=s(C,2),de=a(he),qe=a(de);pa(qe,{class:"w-4 h-4"}),e(de);var xe=s(de,2),Ge=a(xe);e(xe),e(he),e(A);var $e=s(A,2),Je=a($e);B(Je,{variant:"secondary",fullWidth:!0,$$events:{click:()=>pe(r(d))},children:(o,m)=>{v();var W=xa(),I=s(E(W));ca(I,{class:"w-4 h-4 ml-2"}),n(o,W)},$$slots:{default:!0}}),e($e),ye(o=>{F($,o),F(N,r(d).nome_completo),F(We,r(d).email),F(Ge,`Cargo: ${r(d).cargo==="admin"?"Administrador":"Prestador de Serviço"}`)},[()=>r(d).nome_completo?.charAt(0).toUpperCase()]),n(P,S)},$$slots:{default:!0}})}),e(l),n(t,l)};V(Me,t=>{r(M)?t(Te):t(Oe,!1)})}e(_e),e(ee);var De=s(ee,2);{let t=we(()=>r(k)?"Editar Usuário":"Novo Usuário");ta(De,{get isOpen(){return r(h)},get title(){return r(t)},onClose:()=>c(h,!1),children:(l,_)=>{var d=wa(),P=a(d),T=a(P),S=a(T);Ae(S,{class:"w-3 h-3"}),v(),e(T);var u=s(T,2),g=a(u);ce(g,{label:"Nome Completo",placeholder:"Ex: João da Silva",get value(){return r(i).nome_completo},set value(p){q(i,r(i).nome_completo=p)},$$legacy:!0});var x=s(g,2);ce(x,{label:"E-mail de Acesso",type:"email",placeholder:"joao@empresa.com",get value(){return r(i).email},set value(p){q(i,r(i).email=p)},$$legacy:!0}),e(u),e(P);var $=s(P,2),b=a($),w=a(b);ia(w,{class:"w-3 h-3"}),v(),e(b);var N=s(b,2),y=a(N),O=s(a(y),2),U=a(O),se=a(U);Ae(se,{class:"w-6 h-6"}),v(2),e(U);var z=s(U,2),te=a(z);Ce(te,{class:"w-6 h-6"}),v(2),e(z),e(O),e(y);var oe=s(y,2);{let p=we(()=>r(k)?"Nova Senha (deixe em branco para manter)":"Senha de Acesso");ce(oe,{get label(){return r(p)},type:"password",placeholder:"••••••••",get value(){return r(i).password},set value(A){q(i,r(i).password=A)},$$legacy:!0})}e(N),e($);var D=s($,2),L=a(D);B(L,{variant:"secondary",fullWidth:!0,$$events:{click:()=>c(h,!1)},children:(p,A)=>{v();var C=ne("Cancelar");n(p,C)},$$slots:{default:!0}});var le=s(L,2);B(le,{variant:"primary",fullWidth:!0,get loading(){return r(Y)},$$events:{click:Ee},children:(p,A)=>{v();var C=ne("Salvar Usuário");n(p,C)},$$slots:{default:!0}}),e(D),e(d),ye(()=>{ke(U,1,`p-4 rounded-2xl border-2 transition-all flex flex-col items-center gap-2 ${r(i).cargo==="prestador"?"border-brand-500 bg-brand-50 text-brand-700":"border-surface-100 bg-surface-50 text-surface-500 hover:border-surface-200"}`),ke(z,1,`p-4 rounded-2xl border-2 transition-all flex flex-col items-center gap-2 ${r(i).cargo==="admin"?"border-brand-500 bg-brand-50 text-brand-700":"border-surface-100 bg-surface-50 text-surface-500 hover:border-surface-200"}`)}),be("click",U,()=>q(i,r(i).cargo="prestador")),be("click",z,()=>q(i,r(i).cargo="admin")),n(l,d)},$$slots:{default:!0}})}n(H,me),Re(),R()}export{Ja as component};
