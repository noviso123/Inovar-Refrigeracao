import{c as De,a as o,f as n,s as m,e as Q,t as Ce}from"../chunks/DXVr3TX4.js";import{i as tt}from"../chunks/CL5J6ee3.js";import{ad as Bt,a9 as Wt,f as b,p as rt,H as kt,o as Pt,g as e,m as T,h as vt,d as l,c as t,r as a,s as r,n as f,t as S,b as st,l as Za,a as St,u as i,F as Wa,an as ut,G as et,e as ha}from"../chunks/yKYHuomA.js";import{l as va,b as ua,p as Aa,i as u,s as qt,a as ft}from"../chunks/01UUdhOg.js";import{I as fa,c as pa,s as Qe,e as ja,i as Ia,r as pt,a as sa}from"../chunks/TgNKz3rK.js";import{b as at,a as mt}from"../chunks/BoqKQ0gE.js";import{p as Mt}from"../chunks/C2pNFuBR.js";import{g as Vt}from"../chunks/1EbW75xl.js";import{c as Ht}from"../chunks/B7BZ6wJJ.js";import{b as Gt}from"../chunks/CppkIbp3.js";import{T as Nt}from"../chunks/B4UXOIAF.js";import{C as xa}from"../chunks/DGFeEg2X.js";import{X as _t}from"../chunks/Bwf7ILdx.js";import{F as Xt}from"../chunks/D2EUOuic.js";import{C as Ct,U as Jt,S as Qt}from"../chunks/BM-fFNTQ.js";import{C as Yt}from"../chunks/Cjakf9eu.js";import{C as Kt}from"../chunks/BUY1kFW0.js";import{L as ht,B as $e,C as Me}from"../chunks/CMzhJ-sK.js";import{u as Zt}from"../chunks/ZiicVdhW.js";import{I as Ya}from"../chunks/Ul1sdv7C.js";import{B as Ka}from"../chunks/Ba5MWzQS.js";import{R as xt}from"../chunks/ffg_MrFx.js";import{A as er}from"../chunks/C6ROW5sG.js";import{C as ar}from"../chunks/BkbHu8l_.js";import{a as tr,D as gt}from"../chunks/LQrvHcrG.js";import{M as rr}from"../chunks/DLzMKDFg.js";import{L as sr}from"../chunks/BgF-E8vV.js";import{C as or}from"../chunks/BFNN5dmS.js";import{U as ir}from"../chunks/B2Nmx6HV.js";import{P as nr}from"../chunks/Cf_jCYCW.js";import{W as bt}from"../chunks/1lpZ40RF.js";import{M as lr}from"../chunks/BMl328JV.js";import{B as dr}from"../chunks/C4fjolrh.js";import{P as cr}from"../chunks/CnIMmsLf.js";function vr(H,_,q){var L=Bt(H,_);L&&L.set&&(H[_]=q,Wt(()=>{H[_]=null}))}function ur(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"12",cy:"5",r:"1"}],["circle",{cx:"12",cy:"19",r:"1"}]];fa(H,ua({name:"ellipsis-vertical"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function $t(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}],["path",{d:"M12 7v5l4 2"}]];fa(H,ua({name:"history"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function wt(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];fa(H,ua({name:"image"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function fr(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18"}],["path",{d:"m2.3 2.3 7.286 7.286"}],["circle",{cx:"11",cy:"11",r:"2"}]];fa(H,ua({name:"pen-tool"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function pr(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}]];fa(H,ua({name:"pen"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function mr(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];fa(H,ua({name:"send"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}function _r(H,_){const q=va(_,["children","$$slots","$$events","$$legacy"]);const L=[["circle",{cx:"8",cy:"21",r:"1"}],["circle",{cx:"19",cy:"21",r:"1"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"}]];fa(H,ua({name:"shopping-cart"},()=>q,{get iconNode(){return L},children:(Z,p)=>{var c=De(),v=b(c);pa(v,_,"default",{}),o(Z,c)},$$slots:{default:!0}}))}var hr=n('<div class="absolute inset-0 flex items-center justify-center pointer-events-none"><span class="text-surface-400 text-sm">Desenhe sua assinatura aqui</span></div>'),xr=n('<div class="space-y-2"><label class="block text-sm font-medium text-surface-700"> </label> <div class="relative border-2 border-dashed border-surface-300 rounded-xl bg-white overflow-hidden"><canvas class="w-full h-32 cursor-crosshair touch-none"></canvas> <!></div> <div class="flex gap-2 justify-end"><button type="button" class="px-3 py-1.5 text-sm text-surface-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition flex items-center gap-1"><!> Limpar</button> <button type="button"><!> Confirmar</button></div></div>');function yt(H,_){rt(_,!1);let q=Aa(_,"label",8,"Assine aqui"),L=Aa(_,"initialSignature",8,"");const Z=kt();let p=T(),c=null,v=!1,s=T(!1);Pt(()=>{if(!e(p)||(c=e(p).getContext("2d"),!c))return;const j=e(p).getBoundingClientRect();if(vt(p,e(p).width=j.width),vt(p,e(p).height=j.height),c.strokeStyle="#1e40af",c.lineWidth=2,c.lineCap="round",c.lineJoin="round",L()){const w=new Image;w.onload=()=>{c?.drawImage(w,0,0),l(s,!0)},w.src=L()}});function Ve(j){const w=e(p).getBoundingClientRect();return"touches"in j&&j.touches.length>0?{x:j.touches[0].clientX-w.left,y:j.touches[0].clientY-w.top}:"clientX"in j?{x:j.clientX-w.left,y:j.clientY-w.top}:{x:0,y:0}}function G(j){if(j.preventDefault(),!c)return;v=!0;const{x:w,y:le}=Ve(j);c.beginPath(),c.moveTo(w,le)}function I(j){if(!v||!c)return;j.preventDefault();const{x:w,y:le}=Ve(j);c.lineTo(w,le),c.stroke(),l(s,!0)}function fe(){v=!1}function Se(){!c||!e(p)||(c.clearRect(0,0,e(p).width,e(p).height),l(s,!1),Z("clear"))}function ie(){if(!e(p))return;const j=e(p).toDataURL("image/png");Z("save",j)}function A(){return e(p)?.toDataURL("image/png")||""}var Oe={getDataUrl:A};tt();var ze=xr(),Fe=t(ze),Le=t(Fe,!0);a(Fe);var Ye=r(Fe,2),pe=t(Ye);Gt(pe,j=>l(p,j),()=>e(p));var He=r(pe,2);{var oa=j=>{var w=hr();o(j,w)};u(He,j=>{e(s)||j(oa)})}a(Ye);var ma=r(Ye,2),ta=t(ma),ga=t(ta);Nt(ga,{class:"w-4 h-4"}),f(),a(ta);var Ge=r(ta,2),ba=t(Ge);return xa(ba,{class:"w-4 h-4"}),f(),a(Ge),a(ma),a(ze),S(()=>{m(Le,q()),Ge.disabled=!e(s),Qe(Ge,1,`px-4 py-1.5 text-sm rounded-lg transition flex items-center gap-1
        ${e(s)?"bg-brand-500 text-white hover:bg-brand-700":"bg-surface-200 text-surface-400 cursor-not-allowed"}`)}),Q("mousedown",pe,G),Q("mousemove",pe,I),Q("mouseup",pe,fe),Q("mouseleave",pe,fe),Q("touchstart",pe,G),Q("touchmove",pe,I),Q("touchend",pe,fe),Q("click",ta,Se),Q("click",Ge,ie),o(H,ze),vr(_,"getDataUrl",A),st(Oe)}var gr=n("<div></div>"),br=n('<div class="flex-1 relative"><div><div><!></div> <span class="hidden sm:inline"> </span></div> <!></div>'),$r=n('<div class="space-y-4"><div class="flex justify-between items-center"><h3 class="font-bold text-lg">Relatório Técnico</h3> <button class="btn btn-secondary text-sm">Gerar Automático</button></div> <textarea class="input min-h-[200px]" placeholder="Descreva o serviço realizado, peças utilizadas, observações..."></textarea></div>'),wr=n('<!> <span class="text-surface-500">Enviando...</span>',1),yr=n('<!> <span class="text-surface-500">Clique para adicionar fotos</span>',1),kr=n('<div class="relative group aspect-square"><img class="w-full h-full object-cover rounded-lg"/> <button class="absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition"><!></button></div>'),Pr=n('<div class="grid grid-cols-3 gap-3"></div>'),Sr=n('<div class="space-y-4"><h3 class="font-bold text-lg">Fotos do Serviço</h3> <p class="text-surface-500 text-sm">Adicione fotos do serviço realizado (opcional)</p> <label class="border-2 border-dashed border-surface-300 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-brand-400 hover:bg-brand-50/50 transition"><input type="file" class="hidden" accept="image/*" multiple/> <!></label> <!></div>'),Nr=n('<label class="flex items-center gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-xl cursor-pointer"><input type="checkbox" class="rounded"/> <div><p class="font-medium text-yellow-800">Ignorar assinaturas (Admin)</p> <p class="text-sm text-yellow-600">Concluir sem coletar assinaturas</p></div></label>'),Cr=n(`<p class="text-xs text-green-600 mt-1 flex items-center gap-1"><!> Assinatura
                                            capturada</p>`),Dr=n(`<p class="text-xs text-green-600 mt-1 flex items-center gap-1"><!> Assinatura
                                            capturada</p>`),zr=n('<div class="grid gap-6"><div><!> <!></div> <div><!> <!></div></div>'),Ar=n('<div class="space-y-6"><h3 class="font-bold text-lg">Assinaturas</h3> <!> <!></div>'),jr=n('<span class="text-yellow-600">Ignoradas (Admin)</span>'),Ir=n('<div class="space-y-4"><h3 class="font-bold text-lg">Resumo</h3> <div class="bg-surface-50 rounded-xl p-4 space-y-3"><div class="flex justify-between"><span class="text-surface-500">OS</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Cliente</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Valor</span> <span class="font-bold text-brand-600"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Fotos</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Assinaturas</span> <span class="font-medium"><!></span></div></div> <label class="flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-xl cursor-pointer"><input type="checkbox" class="rounded"/> <div><p class="font-medium text-green-800">Confirmar recebimento</p> <p class="text-sm text-green-600">O pagamento foi recebido pelo serviço</p></div></label></div>'),Rr=n("<!> Finalizando...",1),Er=n("<!> Concluir Serviço",1),Or=n('<button class="btn btn-primary"><!></button>'),Tr=n("<button>Próximo <!></button>"),Fr=n('<div class="fixed inset-0 z-50 flex items-center justify-center p-4"><div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div> <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden"><div class="bg-gradient-to-r from-brand-600 to-brand-700 text-white p-6"><div class="flex justify-between items-start"><div><h2 class="text-xl font-bold">Concluir Serviço</h2> <p class="text-brand-100 text-sm mt-1"> </p></div> <button class="p-2 hover:bg-white/10 rounded-xl transition"><!></button></div> <div class="flex gap-2 mt-6"></div></div> <div class="p-6 max-h-[50vh] overflow-y-auto"><!> <!> <!> <!></div> <div class="border-t p-4 flex justify-between"><button><!> Voltar</button> <!></div></div></div>');function Lr(H,_){rt(_,!1);const q=T();let L=Aa(_,"isOpen",8,!1),Z=Aa(_,"isAdmin",8,!1),p=Aa(_,"initialData",24,()=>({}));const c=kt();let v=T(0),s=T(!1),Ve=T(!1),G=T(""),I=T([]),fe=T(null),Se=T(null),ie=T(!1),A=T(!1);const Oe=[{id:"report",title:"Relatório",icon:Xt},{id:"photos",title:"Fotos",icon:Ct},{id:"signatures",title:"Assinaturas",icon:fr},{id:"confirm",title:"Confirmar",icon:xa}];function ze(){c("close"),Fe()}function Fe(){l(v,0),l(G,""),l(I,[]),l(fe,null),l(Se,null),l(ie,!1),l(A,!1)}function Le(){e(v)<Oe.length-1&&ut(v)}function Ye(){e(v)>0&&ut(v,-1)}async function pe(w){const le=w.target;if(!(!le.files||le.files.length===0)){l(Ve,!0);try{const Xe=Array.from(le.files);for(const ia of Xe){const Ke=new FileReader,ra=await new Promise(Ze=>{Ke.onloadend=()=>Ze(Ke.result),Ke.readAsDataURL(ia)});l(I,[...e(I),ra])}}catch(Xe){console.error("Erro no upload:",Xe)}finally{l(Ve,!1),le.value=""}}}function He(w){l(I,e(I).filter((le,Xe)=>Xe!==w))}function oa(w){l(fe,w.detail)}function ma(w){l(Se,w.detail)}async function ta(){l(s,!0);try{const w={technicalReport:e(G),photos:e(I),techSignature:e(A)?null:e(fe),clientSignature:e(A)?null:e(Se),adminBypass:e(A),paymentConfirmed:e(ie)};c("complete",w),ze()}catch(w){console.error("Erro ao finalizar:",w)}finally{l(s,!1)}}function ga(){l(G,`Relatório Técnico - OS #${p().osDisplayNumber||"N/A"}
Cliente: ${p().clienteNome||"N/A"}
Data: ${new Date().toLocaleDateString("pt-BR")}

Descrição do Serviço:
${p().descricao||p().titulo||"Serviço concluído com êxito."}

Valor Total: R$ ${(p().valorTotal||0).toFixed(2)}

Observações:
- Serviço executado conforme solicitação
- Equipamento em pleno funcionamento
- Cliente orientado sobre uso adequado`)}Za(()=>(e(G),e(A),e(fe),e(Se),e(v)),()=>{l(q,{0:e(G).trim().length>10,1:!0,2:e(A)||e(fe)&&e(Se),3:!0}[e(v)]??!1)}),St(),tt();var Ge=De(),ba=b(Ge);{var j=w=>{var le=Fr(),Xe=t(le),ia=r(Xe,2),Ke=t(ia),ra=t(Ke),Ze=t(ra),Ra=r(t(Ze),2),qa=t(Ra);a(Ra),a(Ze);var $a=r(Ze,2),Ma=t($a);_t(Ma,{class:"w-5 h-5"}),a($a),a(ra);var Ea=r(ra,2);ja(Ea,5,()=>Oe,Ia,(R,$,C)=>{var te=br(),ne=t(te),X=t(ne),U=t(X);{var re=ee=>{xa(ee,{class:"w-4 h-4"})},we=ee=>{var me=De(),Ie=b(me);Ht(Ie,()=>e($).icon,(ce,ye)=>{ye(ce,{class:"w-4 h-4"})}),o(ee,me)};u(U,ee=>{C<e(v)?ee(re):ee(we,!1)})}a(X);var F=r(X,2),se=t(F,!0);a(F),a(ne);var Ae=r(ne,2);{var je=ee=>{var me=gr();S(()=>Qe(me,1,`absolute top-4 left-10 right-0 h-0.5 ${C<e(v)?"bg-white":"bg-brand-500/30"}`)),o(ee,me)};u(Ae,ee=>{i(()=>C<Oe.length-1)&&ee(je)})}a(te),S(()=>{Qe(ne,1,`flex items-center gap-2 text-xs font-medium ${C<=e(v)?"text-white":"text-brand-200"}`),Qe(X,1,`w-8 h-8 rounded-full flex items-center justify-center ${C<e(v)?"bg-white text-brand-600":C===e(v)?"bg-white/20 border-2 border-white":"bg-brand-500/30"}`),m(se,(e($),i(()=>e($).title)))}),o(R,te)}),a(Ea),a(Ke);var d=r(Ke,2),h=t(d);{var de=R=>{var $=$r(),C=t($),te=r(t(C),2);a(C);var ne=r(C,2);et(ne),a($),Q("click",te,ga),at(ne,()=>e(G),X=>l(G,X)),o(R,$)};u(h,R=>{e(v)===0&&R(de)})}var Ue=r(h,2);{var ea=R=>{var $=Sr(),C=r(t($),4),te=t(C),ne=r(te,2);{var X=F=>{var se=wr(),Ae=b(se);ht(Ae,{class:"w-8 h-8 text-brand-500 animate-spin mb-2"}),f(2),o(F,se)},U=F=>{var se=yr(),Ae=b(se);Jt(Ae,{class:"w-8 h-8 text-surface-400 mb-2"}),f(2),o(F,se)};u(ne,F=>{e(Ve)?F(X):F(U,!1)})}a(C);var re=r(C,2);{var we=F=>{var se=Pr();ja(se,5,()=>e(I),Ia,(Ae,je,ee)=>{var me=kr(),Ie=t(me);sa(Ie,"alt",`Foto ${ee+1}`);var ce=r(Ie,2),ye=t(ce);_t(ye,{class:"w-3 h-3"}),a(ce),a(me),S(()=>sa(Ie,"src",e(je))),Q("click",ce,()=>He(ee)),o(Ae,me)}),a(se),o(F,se)};u(re,F=>{e(I),i(()=>e(I).length>0)&&F(we)})}a($),S(()=>te.disabled=e(Ve)),Q("change",te,pe),o(R,$)};u(Ue,R=>{e(v)===1&&R(ea)})}var na=r(Ue,2);{var la=R=>{var $=Ar(),C=r(t($),2);{var te=U=>{var re=Nr(),we=t(re);pt(we),f(2),a(re),mt(we,()=>e(A),F=>l(A,F)),o(U,re)};u(C,U=>{Z()&&U(te)})}var ne=r(C,2);{var X=U=>{var re=zr(),we=t(re),F=t(we);yt(F,{label:"Assinatura do Técnico",$$events:{save:oa}});var se=r(F,2);{var Ae=ce=>{var ye=Cr(),da=t(ye);xa(da,{class:"w-3 h-3"}),f(),a(ye),o(ce,ye)};u(se,ce=>{e(fe)&&ce(Ae)})}a(we);var je=r(we,2),ee=t(je);yt(ee,{label:"Assinatura do Cliente",$$events:{save:ma}});var me=r(ee,2);{var Ie=ce=>{var ye=Dr(),da=t(ye);xa(da,{class:"w-3 h-3"}),f(),a(ye),o(ce,ye)};u(me,ce=>{e(Se)&&ce(Ie)})}a(je),a(re),o(U,re)};u(ne,U=>{e(A)||U(X)})}a($),o(R,$)};u(na,R=>{e(v)===2&&R(la)})}var Oa=r(na,2);{var wa=R=>{var $=Ir(),C=r(t($),2),te=t(C),ne=r(t(te),2),X=t(ne);a(ne),a(te);var U=r(te,2),re=r(t(U),2),we=t(re,!0);a(re),a(U);var F=r(U,2),se=r(t(F),2),Ae=t(se);a(se),a(F);var je=r(F,2),ee=r(t(je),2),me=t(ee);a(ee),a(je);var Ie=r(je,2),ce=r(t(Ie),2),ye=t(ce);{var da=Te=>{var ca=jr();o(Te,ca)},Ua=Te=>{var ca=Ce();S(()=>m(ca,e(fe)&&e(Se)?"✅ Coletadas":"⚠️ Pendentes")),o(Te,ca)};u(ye,Te=>{e(A)?Te(da):Te(Ua,!1)})}a(ce),a(Ie),a(C);var ka=r(C,2),Pa=t(ka);pt(Pa),f(2),a(ka),a($),S(Te=>{m(X,`#${Wa(p()),i(()=>p().osDisplayNumber||"N/A")??""}`),m(we,(Wa(p()),i(()=>p().clienteNome||"N/A"))),m(Ae,`R$ ${Te??""}`),m(me,`${e(I),i(()=>e(I).length)??""} foto(s)`)},[()=>(Wa(p()),i(()=>(p().valorTotal||0).toFixed(2)))]),mt(Pa,()=>e(ie),Te=>l(ie,Te)),o(R,$)};u(Oa,R=>{e(v)===3&&R(wa)})}a(d);var ya=r(d,2),aa=t(ya),Ta=t(aa);Yt(Ta,{class:"w-4 h-4"}),f(),a(aa);var Fa=r(aa,2);{var Va=R=>{var $=Or(),C=t($);{var te=X=>{var U=Rr(),re=b(U);ht(re,{class:"w-4 h-4 animate-spin"}),f(),o(X,U)},ne=X=>{var U=Er(),re=b(U);xa(re,{class:"w-4 h-4"}),f(),o(X,U)};u(C,X=>{e(s)?X(te):X(ne,!1)})}a($),S(()=>$.disabled=e(s)),Q("click",$,ta),o(R,$)},La=R=>{var $=Tr(),C=r(t($));Kt(C,{class:"w-4 h-4"}),a($),S(()=>{$.disabled=!e(q),Qe($,1,`btn btn-primary ${e(q)?"":"opacity-50 cursor-not-allowed"}`)}),Q("click",$,Le),o(R,$)};u(Fa,R=>{e(v),i(()=>e(v)===Oe.length-1)?R(Va):R(La,!1)})}a(ya),a(ia),a(le),S(()=>{m(qa,`OS #${Wa(p()),i(()=>p().osDisplayNumber||"N/A")??""}`),aa.disabled=e(v)===0,Qe(aa,1,`btn btn-secondary ${e(v)===0?"opacity-50 cursor-not-allowed":""}`)}),Q("click",Xe,ze),Q("click",$a,ze),Q("click",aa,Ye),o(w,le)};u(ba,w=>{L()&&w(j)})}o(H,Ge),st()}var Ur=n('<div class="p-12 text-center"><!></div>'),Br=n('<div class="flex items-center gap-2 text-brand-600 font-black"><!> </div>'),Wr=n("<!> PDF",1),qr=n("<!> Enviar OS",1),Mr=n("<!> Enviar PIX",1),Vr=n("<!> Salvar",1),Hr=n("<!> Editar",1),Gr=n('<textarea class="w-full min-h-[160px] p-4 bg-surface-50 border border-surface-200 rounded-2xl outline-none focus:border-brand-500 transition-all font-medium" placeholder="Descreva o problema..."></textarea>'),Xr=n('<div class="text-surface-700 leading-relaxed font-medium whitespace-pre-wrap text-lg"> </div>'),Jr=n('<div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black uppercase tracking-widest text-surface-400">Descrição Detalhada</h3> <!></div> <!>',1),Qr=n('<h4 class="font-black text-blue-900 mb-4 flex items-center gap-2"><!> Equipamento</h4> <p class="text-blue-800 font-bold"><!></p>',1),Yr=n('<h4 class="font-black text-brand-900 mb-4 flex items-center gap-2"><!> Localização</h4> <p class="text-brand-800 font-bold"> </p>',1),Kr=n('<div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">CNPJ</p> <p class="font-bold"> </p></div>'),Zr=n('<div class="space-y-4"><div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">Endereço</p> <p class="font-bold leading-relaxed"> <!> <br/> <br/> </p></div></div>'),es=n('<div class="flex items-center gap-3 mb-6"><!> <h3 class="text-sm font-black uppercase tracking-widest text-brand-400">Dados da Empresa (Emissor)</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="space-y-4"><div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">Nome Fantasia</p> <p class="text-xl font-black"> </p></div> <!></div> <!></div>',1),as=n('<div class="space-y-8"><!> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <!></div> <!></div>'),ts=n(`<!> Adicionar
                                            Item`,1),rs=n('<div class="bg-surface-50 p-6 rounded-2xl border border-surface-200 space-y-4 mb-8"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div class="md:col-span-2"><!></div> <!> <!></div> <!></div>'),ss=n('<th class="p-4 w-16"></th>'),os=n('<td class="p-4 text-center"><button class="text-red-400 hover:text-red-600 transition-colors"><!></button></td>'),is=n('<tr class="hover:bg-surface-50/50 transition-colors font-bold text-surface-700"><td class="p-4"> </td><td class="p-4 text-center"> </td><td class="p-4 text-right"> </td><td class="p-4 text-right text-surface-900"> </td><!></tr>'),ns=n('<tr><td class="p-12 text-center text-surface-400 font-medium italic">Nenhum item adicionado.</td></tr>'),ls=n('<div class="flex justify-between items-center mb-8"><h3 class="text-xl font-black text-surface-900">Itens do Serviço</h3> <!></div> <!> <div class="border border-surface-200 rounded-2xl overflow-hidden"><table class="w-full text-sm"><thead class="bg-surface-50 text-surface-400 font-black uppercase tracking-widest text-[10px]"><tr><th class="p-4 text-left">Descrição</th><th class="p-4 text-center">Qtd</th><th class="p-4 text-right">Unitário</th><th class="p-4 text-right">Total</th><!></tr></thead><tbody class="divide-y divide-surface-100"></tbody><tfoot class="bg-surface-900 text-white"><tr><td class="p-6 text-right font-black uppercase tracking-widest text-xs">Total Geral</td><td class="p-6 text-right text-2xl font-black"> </td></tr></tfoot></table></div> <!>',1),ds=n('<h4 class="font-black text-brand-900 mb-6 flex items-center gap-3"><!> Diário de Obra</h4> <div class="flex gap-4"><textarea class="flex-1 bg-white border border-surface-200 p-4 rounded-2xl text-sm font-medium outline-none focus:border-brand-500 transition-all" placeholder="Descreva a atividade realizada agora..." rows="2"></textarea> <!></div>',1),cs=n('<img class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"/> <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><!></div>',1),vs=n('<div class="col-span-full py-20 text-center border-2 border-dashed border-surface-200 rounded-3xl"><!> <p class="text-surface-400 font-bold">Nenhuma foto registrada ainda.</p></div>'),us=n('<div class="space-y-8"><!> <div class="grid grid-cols-2 md:grid-cols-3 gap-4"></div></div>'),fs=n('<div class="absolute left-[11px] top-8 bottom-0 w-0.5 bg-surface-100"></div>'),ps=n('<div class="relative pl-8 pb-8 last:pb-0"><!> <div class="absolute left-0 top-1.5 w-6 h-6 rounded-full bg-brand-50 border-4 border-white shadow-sm flex items-center justify-center"><div class="w-1.5 h-1.5 rounded-full bg-brand-600"></div></div> <div><div class="flex items-center gap-3 mb-2"><span class="text-xs font-black text-surface-400 uppercase tracking-widest"> </span> <!></div> <p class="text-surface-700 font-bold leading-relaxed"> </p></div></div>'),ms=n('<div class="text-center py-12"><!> <p class="text-surface-400 font-bold">Nenhum registro no histórico.</p></div>'),_s=n('<div class="space-y-8"></div>'),hs=n('<h3 class="font-black text-lg mb-6 flex items-center gap-2"><!> Status do Serviço</h3> <div class="space-y-3"><!> <!> <!> <!></div>',1),xs=n('<div><p class="text-[10px] font-black text-surface-400 uppercase tracking-widest mb-1">Contato</p> <a class="flex items-center gap-2 text-brand-600 font-black hover:underline"><!> </a></div>'),gs=n('<h3 class="font-black text-surface-900 mb-6 flex items-center gap-2"><!> Cliente</h3> <div class="space-y-4"><div><p class="text-[10px] font-black text-surface-400 uppercase tracking-widest mb-1">Nome</p> <p class="font-bold text-surface-900"> </p></div> <!></div>',1),bs=n('<h3 class="font-black text-surface-900 mb-6 flex items-center gap-2"><!> Responsável</h3> <div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-surface-100 flex items-center justify-center font-black text-surface-600"> </div> <p class="font-bold text-surface-900"> </p></div>',1),$s=n('<div class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-surface-200 px-4 py-3"><div class="max-w-7xl mx-auto flex items-center justify-between"><div class="flex items-center gap-4"><!> <div><div class="flex items-center gap-2"><!> <!></div></div></div> <div class="flex items-center gap-2"><!> <!></div></div></div> <div class="bg-white border-b border-surface-200"><div class="max-w-7xl mx-auto px-4 py-8"><div class="flex flex-col md:flex-row justify-between items-start gap-6"><div class="space-y-4 flex-1"><h1 class="text-4xl font-black text-surface-900 tracking-tight leading-tight"> </h1> <div class="flex flex-wrap items-center gap-6 text-sm font-medium text-surface-500"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-full bg-brand-50 flex items-center justify-center text-brand-600 font-black"> </div> <span class="text-surface-900 font-bold"> </span></div> <div class="flex items-center gap-2"><!> </div> <!></div></div> <div class="flex gap-3 w-full md:w-auto"><!> <!> <!></div></div></div></div> <div class="max-w-7xl mx-auto px-4 py-8"><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2 space-y-8"><div class="flex gap-2 p-1.5 bg-surface-100/50 rounded-2xl border border-surface-200 overflow-x-auto no-scrollbar svelte-zlgf0w"><button><!> Visão Geral</button> <button><!> Itens</button> <button><!> Fotos</button> <button><!> Histórico</button></div> <div class="animate-in fade-in slide-in-from-bottom-4 duration-500"><!></div></div> <div class="space-y-6"><!> <!> <!></div></div></div>',1),ws=n('<div class="fixed inset-0 z-[100] flex items-center justify-center p-4"><div class="absolute inset-0 bg-surface-900/60 backdrop-blur-md"></div> <div class="relative w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-white rounded-3xl shadow-2xl"><!></div></div>'),ys=n('<div class="min-h-screen bg-surface-50 pb-24"><!></div> <!>',1);function so(H,_){rt(_,!1);const q=()=>ft(Mt,"$page",Z),L=()=>ft(Zt,"$user",Z),[Z,p]=qt(),c=T(),v=T();let s=T(null),Ve=T(!0),G=T(!1),I=T("overview"),fe=T(!1),Se=T(""),ie=T(!1),A=T([]),Oe=T(""),ze=T(1),Fe=T(0),Le=T("");async function Ye(){try{const d=localStorage.getItem("token"),h=await fetch(`/api/solicitacoes/${e(c)}`,{headers:{Authorization:`Bearer ${d}`}});h.ok&&(l(s,await h.json()),l(A,[...e(s)?.itens_os||[]]))}catch(d){console.error("Erro ao carregar OS:",d)}finally{l(Ve,!1)}}async function pe(d){l(G,!0);try{const h=localStorage.getItem("token");await fetch(`/api/solicitacoes/${e(c)}`,{method:"PUT",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify(d)}),await Ye()}catch(h){console.error("Erro ao atualizar:",h)}finally{l(G,!1)}}let He=T(!1);async function oa(d){if(d==="concluido"){l(He,!0);return}await pe({status:d})}async function ma(d){const h=d.detail,de={status:"concluido",technical_report:h.technicalReport,fotos:[...e(s)?.fotos||[],...h.photos.map(ea=>({url:ea}))]},Ue={data:new Date().toISOString(),descricao:`Serviço concluído via Wizard. Pagamento ${h.paymentConfirmed?"confirmado":"pendente"}.`,usuario:L()?.nome_completo||"Usuário"};de.historico=[...e(s)?.historico||[],Ue],await pe(de),l(He,!1)}async function ta(){await pe({descricao_detalhada:e(Se)}),l(fe,!1)}function ga(){if(!e(Oe).trim())return;const d=e(ze)*e(Fe);l(A,[...e(A),{descricao:e(Oe),quantidade:e(ze),valor_unitario:e(Fe),valor_total:d}]),l(Oe,""),l(ze,1),l(Fe,0)}function Ge(d){l(A,e(A).filter((h,de)=>de!==d))}async function ba(){const d=e(A).reduce((h,de)=>h+de.valor_total,0);await pe({itens_os:e(A),valor_total:d,orcamento_disponivel:!0}),l(ie,!1)}async function j(){if(!e(Le).trim())return;const d={data:new Date().toISOString(),descricao:`[Diário de Obra] ${e(Le)}`,usuario:"Técnico"},h=e(s)?.historico||[];await pe({historico:[...h,d]}),l(Le,"")}function w(d){return new Date(d).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}function le(d){return d.toLocaleString("pt-BR",{minimumFractionDigits:2})}function Xe(d){return{pendente:"warning",agendado:"info",em_andamento:"brand",concluido:"success",faturado:"success",cancelado:"danger"}[d]||"neutral"}async function ia(d){l(G,!0);try{const h=localStorage.getItem("token"),de=await fetch(`/api/solicitacoes/${e(c)}/send-whatsapp?type=${d}`,{method:"POST",headers:{Authorization:`Bearer ${h}`}});if(de.ok)alert(`Solicitação de envio de ${d.toUpperCase()} enfileirada!`);else{const Ue=await de.json();alert(`Erro: ${Ue.detail||"Falha ao enfileirar"}`)}}catch(h){console.error("Erro ao enviar WhatsApp:",h)}finally{l(G,!1)}}function Ke(){const d=localStorage.getItem("token");window.open(`/api/solicitacoes/${e(c)}/pdf?token=${d}`,"_blank")}Pt(()=>{Ye()}),Za(()=>q(),()=>{l(c,q().params.id)}),Za(()=>e(A),()=>{l(v,e(A).reduce((d,h)=>d+h.valor_total,0))}),St(),tt();var ra=ys(),Ze=b(ra),Ra=t(Ze);{var qa=d=>{var h=Ur(),de=t(h);xt(de,{class:"w-12 h-12 animate-spin mx-auto text-brand-500 opacity-20"}),a(h),o(d,h)},$a=d=>{var h=De(),de=b(h);{var Ue=ea=>{var na=$s(),la=b(na),Oa=t(la),wa=t(Oa),ya=t(wa);$e(ya,{variant:"ghost",size:"sm",className:"p-2",$$events:{click:()=>Vt("/solicitacoes")},children:(x,B)=>{er(x,{class:"w-5 h-5"})},$$slots:{default:!0}});var aa=r(ya,2),Ta=t(aa),Fa=t(Ta);Ka(Fa,{variant:"neutral",size:"sm",className:"bg-surface-900 text-white border-none",children:(x,B)=>{f();var D=Ce();S(()=>m(D,`OS #${e(s),i(()=>e(s).sequential_id)??""}`)),o(x,D)},$$slots:{default:!0}});var Va=r(Fa,2);{let x=ha(()=>(e(s),i(()=>Xe(e(s).status))));Ka(Va,{get variant(){return e(x)},children:(B,D)=>{f();var E=Ce();S(xe=>m(E,xe),[()=>(e(s),i(()=>e(s).status.replace("_"," ")))]),o(B,E)},$$slots:{default:!0}})}a(Ta),a(aa),a(wa);var La=r(wa,2),R=t(La);$e(R,{variant:"secondary",size:"sm",get loading(){return e(G)},$$events:{click:Ye},children:(x,B)=>{{let D=ha(()=>e(G)?"animate-spin":"");xt(x,{get class(){return`w-4 h-4 ${e(D)??""}`}})}},$$slots:{default:!0}});var $=r(R,2);$e($,{variant:"secondary",size:"sm",children:(x,B)=>{ur(x,{class:"w-4 h-4"})},$$slots:{default:!0}}),a(La),a(Oa),a(la);var C=r(la,2),te=t(C),ne=t(te),X=t(ne),U=t(X),re=t(U,!0);a(U);var we=r(U,2),F=t(we),se=t(F),Ae=t(se,!0);a(se);var je=r(se,2),ee=t(je,!0);a(je),a(F);var me=r(F,2),Ie=t(me);ar(Ie,{class:"w-4 h-4 text-surface-400"});var ce=r(Ie);a(me);var ye=r(me,2);{var da=x=>{var B=Br(),D=t(B);gt(D,{class:"w-4 h-4"});var E=r(D);a(B),S(xe=>m(E,` R$ ${xe??""}`),[()=>(e(s),i(()=>le(e(s).valor_total)))]),o(x,B)};u(ye,x=>{e(s),i(()=>e(s).valor_total)&&x(da)})}a(we),a(X);var Ua=r(X,2),ka=t(Ua);$e(ka,{variant:"secondary",className:"flex-1 md:flex-none border-surface-200",$$events:{click:Ke},children:(x,B)=>{var D=Wr(),E=b(D);tr(E,{class:"w-4 h-4 mr-2"}),f(),o(x,D)},$$slots:{default:!0}});var Pa=r(ka,2);$e(Pa,{variant:"secondary",className:"flex-1 md:flex-none bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border-emerald-200 transition-all active:scale-95",get loading(){return e(G)},$$events:{click:()=>ia("pdf")},children:(x,B)=>{var D=qr(),E=b(D);rr(E,{class:"w-4 h-4 mr-2"}),f(),o(x,D)},$$slots:{default:!0}});var Te=r(Pa,2);$e(Te,{variant:"secondary",className:"flex-1 md:flex-none bg-brand-50 text-brand-700 hover:bg-brand-100 border-brand-200 transition-all active:scale-95",get loading(){return e(G)},$$events:{click:()=>ia("pix")},children:(x,B)=>{var D=Mr(),E=b(D);gt(E,{class:"w-4 h-4 mr-2"}),f(),o(x,D)},$$slots:{default:!0}}),a(Ua),a(ne),a(te),a(C);var ca=r(C,2),ot=t(ca),Ha=t(ot),Ga=t(Ha),Sa=t(Ga),Dt=t(Sa);sr(Dt,{class:"w-4 h-4"}),f(),a(Sa);var Na=r(Sa,2),zt=t(Na);_r(zt,{class:"w-4 h-4"}),f(),a(Na);var Ca=r(Na,2),At=t(Ca);wt(At,{class:"w-4 h-4"}),f(),a(Ca);var Ba=r(Ca,2),jt=t(Ba);$t(jt,{class:"w-4 h-4"}),f(),a(Ba),a(Ga);var it=r(Ga,2),It=t(it);{var Rt=x=>{var B=as(),D=t(B);Me(D,{padding:"p-8",children:(ae,_e)=>{var W=Jr(),y=b(W),Y=r(t(y),2);$e(Y,{variant:"ghost",size:"sm",$$events:{click:()=>{e(fe)?ta():(l(Se,e(s)?.descricao_detalhada||""),l(fe,!0))}},children:(P,N)=>{var K=De(),M=b(K);{var ve=oe=>{var J=Vr(),ue=b(J);Qt(ue,{class:"w-4 h-4 mr-2"}),f(),o(oe,J)},ke=oe=>{var J=Hr(),ue=b(J);pr(ue,{class:"w-4 h-4 mr-2"}),f(),o(oe,J)};u(M,oe=>{e(fe)?oe(ve):oe(ke,!1)})}o(P,K)},$$slots:{default:!0}}),a(y);var g=r(y,2);{var k=P=>{var N=Gr();et(N),at(N,()=>e(Se),K=>l(Se,K)),o(P,N)},z=P=>{var N=Xr(),K=t(N,!0);a(N),S(()=>m(K,(e(s),i(()=>e(s).descricao_detalhada||"Sem descrição detalhada.")))),o(P,N)};u(g,P=>{e(fe)?P(k):P(z,!1)})}o(ae,W)},$$slots:{default:!0}});var E=r(D,2),xe=t(E);Me(xe,{padding:"p-6",className:"bg-blue-50/50 border-blue-100",children:(ae,_e)=>{var W=Qr(),y=b(W),Y=t(y);bt(Y,{class:"w-5 h-5"}),f(),a(y);var g=r(y,2),k=t(g);{var z=N=>{var K=Ce();S(()=>m(K,`${e(A),i(()=>e(A).length)??""} item(ns) vinculado(s)`)),o(N,K)},P=N=>{var K=Ce("Nenhum equipamento vinculado.");o(N,K)};u(k,N=>{e(A),i(()=>e(A).length>0)?N(z):N(P,!1)})}a(g),o(ae,W)},$$slots:{default:!0}});var ge=r(xe,2);Me(ge,{padding:"p-6",className:"bg-brand-50/50 border-brand-100",children:(ae,_e)=>{var W=Yr(),y=b(W),Y=t(y);lr(Y,{class:"w-5 h-5"}),f(),a(y);var g=r(y,2),k=t(g,!0);a(g),S(()=>m(k,(e(s),i(()=>e(s).local?.address||"Endereço não cadastrado")))),o(ae,W)},$$slots:{default:!0}}),a(E);var be=r(E,2);{var Re=ae=>{Me(ae,{padding:"p-8",className:"bg-surface-900 text-white",children:(_e,W)=>{var y=es(),Y=b(y),g=t(Y);dr(g,{class:"w-6 h-6 text-brand-400"}),f(2),a(Y);var k=r(Y,2),z=t(k),P=t(z),N=r(t(P),2),K=t(N,!0);a(N),a(P);var M=r(P,2);{var ve=J=>{var ue=Kr(),Ee=r(t(ue),2),Je=t(Ee,!0);a(Ee),a(ue),S(()=>m(Je,(e(s),i(()=>e(s).empresa.cnpj)))),o(J,ue)};u(M,J=>{e(s),i(()=>e(s).empresa.cnpj)&&J(ve)})}a(z);var ke=r(z,2);{var oe=J=>{var ue=Zr(),Ee=t(ue),Je=r(t(Ee),2),V=t(Je),O=r(V);{var Ne=Be=>{var We=Ce();S(()=>m(We,`- ${e(s),i(()=>e(s).empresa.endereco.complemento)??""}`)),o(Be,We)};u(O,Be=>{e(s),i(()=>e(s).empresa.endereco.complemento)&&Be(Ne)})}var he=r(O,3),Pe=r(he,2);a(Je),a(Ee),a(ue),S(()=>{m(V,`${e(s),i(()=>e(s).empresa.endereco.logradouro)??""}, ${e(s),i(()=>e(s).empresa.endereco.numero)??""} `),m(he,` ${e(s),i(()=>e(s).empresa.endereco.bairro)??""} - ${e(s),i(()=>e(s).empresa.endereco.cidade)??""}/${e(s),i(()=>e(s).empresa.endereco.estado)??""} `),m(Pe,` CEP: ${e(s),i(()=>e(s).empresa.endereco.cep)??""}`)}),o(J,ue)};u(ke,J=>{e(s),i(()=>e(s).empresa.endereco)&&J(oe)})}a(k),S(()=>m(K,(e(s),i(()=>e(s).empresa.nome_fantasia)))),o(_e,y)},$$slots:{default:!0}})};u(be,ae=>{e(s),i(()=>e(s).empresa)&&ae(Re)})}a(B),o(x,B)},Et=x=>{var B=De(),D=b(B);{var E=ge=>{Me(ge,{padding:"p-8",children:(be,Re)=>{var ae=ls(),_e=b(ae),W=r(t(_e),2);{let V=ha(()=>e(ie)?"danger":"secondary");$e(W,{get variant(){return e(V)},size:"sm",$$events:{click:()=>l(ie,!e(ie))},children:(O,Ne)=>{f();var he=Ce();S(()=>m(he,e(ie)?"Cancelar":"Editar Itens")),o(O,he)},$$slots:{default:!0}})}a(_e);var y=r(_e,2);{var Y=V=>{var O=rs(),Ne=t(O),he=t(Ne),Pe=t(he);Ya(Pe,{label:"Descrição",placeholder:"Ex: Carga de Gás",get value(){return e(Oe)},set value(qe){l(Oe,qe)},$$legacy:!0}),a(he);var Be=r(he,2);Ya(Be,{label:"Qtd",type:"number",get value(){return e(ze)},set value(qe){l(ze,qe)},$$legacy:!0});var We=r(Be,2);Ya(We,{label:"Preço Unit.",type:"number",get value(){return e(Fe)},set value(qe){l(Fe,qe)},$$legacy:!0}),a(Ne);var Xa=r(Ne,2);$e(Xa,{variant:"primary",fullWidth:!0,$$events:{click:ga},children:(qe,ct)=>{var _a=ts(),Ja=b(_a);cr(Ja,{class:"w-4 h-4 mr-2"}),f(),o(qe,_a)},$$slots:{default:!0}}),a(O),o(V,O)};u(y,V=>{e(ie)&&V(Y)})}var g=r(y,2),k=t(g),z=t(k),P=t(z),N=r(t(P),4);{var K=V=>{var O=ss();o(V,O)};u(N,V=>{e(ie)&&V(K)})}a(P),a(z);var M=r(z);ja(M,5,()=>e(A),Ia,(V,O,Ne)=>{var he=is(),Pe=t(he),Be=t(Pe,!0);a(Pe);var We=r(Pe),Xa=t(We,!0);a(We);var qe=r(We),ct=t(qe);a(qe);var _a=r(qe),Ja=t(_a);a(_a);var Ft=r(_a);{var Lt=Da=>{var za=os(),Qa=t(za),Ut=t(Qa);Nt(Ut,{class:"w-4 h-4"}),a(Qa),a(za),Q("click",Qa,()=>Ge(Ne)),o(Da,za)};u(Ft,Da=>{e(ie)&&Da(Lt)})}a(he),S((Da,za)=>{m(Be,(e(O),i(()=>e(O).descricao))),m(Xa,(e(O),i(()=>e(O).quantidade))),m(ct,`R$ ${Da??""}`),m(Ja,`R$ ${za??""}`)},[()=>(e(O),i(()=>le(e(O).valor_unitario))),()=>(e(O),i(()=>le(e(O).valor_total)))]),o(V,he)},V=>{var O=ns(),Ne=t(O);a(O),S(()=>sa(Ne,"colspan",e(ie)?5:4)),o(V,O)}),a(M);var ve=r(M),ke=t(ve),oe=t(ke),J=r(oe),ue=t(J);a(J),a(ke),a(ve),a(k),a(g);var Ee=r(g,2);{var Je=V=>{$e(V,{variant:"primary",fullWidth:!0,className:"mt-8 py-4 text-lg",get loading(){return e(G)},$$events:{click:ba},children:(O,Ne)=>{f();var he=Ce("Salvar Orçamento");o(O,he)},$$slots:{default:!0}})};u(Ee,V=>{e(ie)&&V(Je)})}S(V=>{sa(oe,"colspan",e(ie)?3:2),sa(J,"colspan",(e(ie),2)),m(ue,`R$ ${V??""}`)},[()=>(e(v),i(()=>le(e(v))))]),o(be,ae)},$$slots:{default:!0}})},xe=ge=>{var be=De(),Re=b(be);{var ae=W=>{var y=us(),Y=t(y);Me(Y,{padding:"p-8",className:"bg-brand-50/30 border-brand-100",children:(k,z)=>{var P=ds(),N=b(P),K=t(N);Ct(K,{class:"w-6 h-6"}),f(),a(N);var M=r(N,2),ve=t(M);et(ve);var ke=r(ve,2);{let oe=ha(()=>(e(Le),i(()=>!e(Le).trim())));$e(ke,{variant:"primary",get disabled(){return e(oe)},className:"h-auto px-6",$$events:{click:j},children:(J,ue)=>{mr(J,{class:"w-5 h-5"})},$$slots:{default:!0}})}a(M),at(ve,()=>e(Le),oe=>l(Le,oe)),o(k,P)},$$slots:{default:!0}});var g=r(Y,2);ja(g,5,()=>(e(s),i(()=>e(s).fotos||[])),Ia,(k,z,P)=>{Me(k,{padding:"p-0",className:"aspect-square overflow-hidden group relative",children:(N,K)=>{var M=cs(),ve=b(M);sa(ve,"alt",`Evidência ${P+1}`);var ke=r(ve,2),oe=t(ke);$e(oe,{variant:"secondary",size:"sm",$$events:{click:()=>window.open(e(z).url,"_blank")},children:(J,ue)=>{f();var Ee=Ce("Ver Foto");o(J,Ee)},$$slots:{default:!0}}),a(ke),S(()=>sa(ve,"src",(e(z),i(()=>e(z).url)))),o(N,M)},$$slots:{default:!0}})},k=>{var z=vs(),P=t(z);wt(P,{class:"w-16 h-16 text-surface-200 mx-auto mb-4"}),f(2),a(z),o(k,z)}),a(g),a(y),o(W,y)},_e=W=>{var y=De(),Y=b(y);{var g=k=>{Me(k,{padding:"p-8",children:(z,P)=>{var N=_s();ja(N,5,()=>(e(s),i(()=>e(s).historico||[])),Ia,(K,M,ve)=>{var ke=ps(),oe=t(ke);{var J=Pe=>{var Be=fs();o(Pe,Be)};u(oe,Pe=>{e(s),i(()=>ve!==(e(s).historico?.length||0)-1)&&Pe(J)})}var ue=r(oe,4),Ee=t(ue),Je=t(Ee),V=t(Je,!0);a(Je);var O=r(Je,2);Ka(O,{variant:"neutral",size:"sm",children:(Pe,Be)=>{f();var We=Ce();S(()=>m(We,(e(M),i(()=>e(M).usuario)))),o(Pe,We)},$$slots:{default:!0}}),a(Ee);var Ne=r(Ee,2),he=t(Ne,!0);a(Ne),a(ue),a(ke),S(Pe=>{m(V,Pe),m(he,(e(M),i(()=>e(M).descricao)))},[()=>(e(M),i(()=>w(e(M).data)))]),o(K,ke)},K=>{var M=ms(),ve=t(M);$t(ve,{class:"w-16 h-16 text-surface-100 mx-auto mb-4"}),f(2),a(M),o(K,M)}),a(N),o(z,N)},$$slots:{default:!0}})};u(Y,k=>{e(I)==="history"&&k(g)},!0)}o(W,y)};u(Re,W=>{e(I)==="photos"?W(ae):W(_e,!1)},!0)}o(ge,be)};u(D,ge=>{e(I)==="services"?ge(E):ge(xe,!1)},!0)}o(x,B)};u(It,x=>{e(I)==="overview"?x(Rt):x(Et,!1)})}a(it),a(Ha);var nt=r(Ha,2),lt=t(nt);Me(lt,{padding:"p-6",className:"bg-surface-900 text-white border-none shadow-2xl shadow-surface-200",children:(x,B)=>{var D=hs(),E=b(D),xe=t(E);or(xe,{class:"w-5 h-5 text-brand-400"}),f(),a(E);var ge=r(E,2),be=t(ge);{var Re=g=>{$e(g,{fullWidth:!0,variant:"primary",get loading(){return e(G)},$$events:{click:()=>oa("agendado")},children:(k,z)=>{f();var P=Ce("Agendar Visita");o(k,P)},$$slots:{default:!0}})};u(be,g=>{e(s),i(()=>e(s).status==="pendente")&&g(Re)})}var ae=r(be,2);{var _e=g=>{$e(g,{fullWidth:!0,variant:"primary",get loading(){return e(G)},$$events:{click:()=>oa("em_andamento")},children:(k,z)=>{f();var P=Ce("Iniciar Serviço");o(k,P)},$$slots:{default:!0}})};u(ae,g=>{e(s),i(()=>e(s).status==="agendado")&&g(_e)})}var W=r(ae,2);{var y=g=>{$e(g,{fullWidth:!0,variant:"success",get loading(){return e(G)},$$events:{click:()=>oa("concluido")},children:(k,z)=>{f();var P=Ce("Finalizar OS");o(k,P)},$$slots:{default:!0}})};u(W,g=>{e(s),i(()=>["pendente","agendado","em_andamento"].includes(e(s).status))&&g(y)})}var Y=r(W,2);$e(Y,{fullWidth:!0,variant:"danger",className:"bg-white/10 text-white border-white/10 hover:bg-red-500/20",children:(g,k)=>{f();var z=Ce("Cancelar Chamado");o(g,z)},$$slots:{default:!0}}),a(ge),o(x,D)},$$slots:{default:!0}});var dt=r(lt,2);Me(dt,{padding:"p-6",children:(x,B)=>{var D=gs(),E=b(D),xe=t(E);ir(xe,{class:"w-5 h-5 text-brand-600"}),f(),a(E);var ge=r(E,2),be=t(ge),Re=r(t(be),2),ae=t(Re,!0);a(Re),a(be);var _e=r(be,2);{var W=y=>{var Y=xs(),g=r(t(Y),2),k=t(g);nr(k,{class:"w-4 h-4"});var z=r(k);a(g),a(Y),S(()=>{sa(g,"href",`tel:${e(s),i(()=>e(s).cliente.telefone)??""}`),m(z,` ${e(s),i(()=>e(s).cliente.telefone)??""}`)}),o(y,Y)};u(_e,y=>{e(s),i(()=>e(s).cliente?.telefone)&&y(W)})}a(ge),S(()=>m(ae,(e(s),i(()=>e(s).cliente?.nome)))),o(x,D)},$$slots:{default:!0}});var Ot=r(dt,2);{var Tt=x=>{Me(x,{padding:"p-6",children:(B,D)=>{var E=bs(),xe=b(E),ge=t(xe);bt(ge,{class:"w-5 h-5 text-brand-600"}),f(),a(xe);var be=r(xe,2),Re=t(be),ae=t(Re,!0);a(Re);var _e=r(Re,2),W=t(_e,!0);a(_e),a(be),S(y=>{m(ae,y),m(W,(e(s),i(()=>e(s).tecnico.nome_completo)))},[()=>(e(s),i(()=>e(s).tecnico.nome_completo.charAt(0)))]),o(B,E)},$$slots:{default:!0}})};u(Ot,x=>{e(s),i(()=>e(s).tecnico)&&x(Tt)})}a(nt),a(ot),a(ca),S((x,B)=>{m(re,(e(s),i(()=>e(s).titulo))),m(Ae,x),m(ee,(e(s),i(()=>e(s).cliente?.nome))),m(ce,` ${B??""}`),Qe(Sa,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(I)==="overview"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Qe(Na,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(I)==="services"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Qe(Ca,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(I)==="photos"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Qe(Ba,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(I)==="history"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`)},[()=>(e(s),i(()=>e(s).cliente?.nome?.charAt(0)||"?")),()=>(e(s),i(()=>w(e(s).created_at)))]),Q("click",Sa,()=>l(I,"overview")),Q("click",Na,()=>l(I,"services")),Q("click",Ca,()=>l(I,"photos")),Q("click",Ba,()=>l(I,"history")),o(ea,na)};u(de,ea=>{e(s)&&ea(Ue)},!0)}o(d,h)};u(Ra,d=>{e(Ve)?d(qa):d($a,!1)})}a(Ze);var Ma=r(Ze,2);{var Ea=d=>{var h=ws(),de=t(h),Ue=r(de,2),ea=t(Ue);{let na=ha(()=>(L(),i(()=>L()?.cargo==="admin"))),la=ha(()=>(e(s),i(()=>({titulo:e(s).titulo,descricao:e(s).descricao_detalhada,valorTotal:e(s).valor_total||0,osDisplayNumber:e(s).sequential_id.toString(),clienteNome:e(s).cliente?.nome}))));Lr(ea,{get isOpen(){return e(He)},get isAdmin(){return e(na)},get initialData(){return e(la)},$$events:{complete:ma,close:()=>l(He,!1)}})}a(Ue),a(h),Q("click",de,()=>l(He,!1)),o(d,h)};u(Ma,d=>{e(s)&&e(He)&&d(Ea)})}o(H,ra),st(),p()}export{so as component};
