import{c as je,a as o,f as n,s as m,e as Q,t as ze}from"../chunks/ChkOC8jJ.js";import{i as ea}from"../chunks/0BXEIW7p.js";import{ad as Ta,a9 as Fa,f as g,p as ta,H as ba,o as $a,g as e,m as R,h as la,d as l,c as a,r as t,s as r,n as p,t as S,b as aa,l as Yt,a as wa,u as i,F as Bt,an as da,G as Kt,e as ht}from"../chunks/uipimv4g.js";import{l as dt,b as ct,p as jt,i as u,s as La,a as ca}from"../chunks/37VJptNz.js";import{I as vt,c as ut,s as Ye,e as At,i as It,r as va,a as it}from"../chunks/CVNGJ9si.js";import{b as Zt,a as ua}from"../chunks/D8wqnib1.js";import{p as Ua}from"../chunks/BzIHomkv.js";import{g as Ba}from"../chunks/5eTJf3XV.js";import{c as qa}from"../chunks/DfCvXC3A.js";import{b as Wa}from"../chunks/OJeHAvqz.js";import{T as ya}from"../chunks/7_4oUfLD.js";import{C as xt}from"../chunks/CflctUyn.js";import{X as fa}from"../chunks/BL3mg1O4.js";import{F as Ma}from"../chunks/CiL3XSW0.js";import{C as ka,U as Va,S as Ha}from"../chunks/BKdBfhCW.js";import{C as Ga}from"../chunks/jx1cVd07.js";import{C as Xa}from"../chunks/BIl_OTr6.js";import{L as pa,B as De,C as We}from"../chunks/CcITqVFh.js";import{u as Ja}from"../chunks/DW2QD1qa.js";import{I as Jt}from"../chunks/DEJ6kVJ0.js";import{B as Qt}from"../chunks/20U3f4mM.js";import{R as ma}from"../chunks/DNnFxnH_.js";import{A as Qa}from"../chunks/Cog2Q5df.js";import{C as Ya}from"../chunks/B6wGs7uP.js";import{a as Ka,D as Za}from"../chunks/BH7u1eap.js";import{L as er}from"../chunks/BvK2kZ7w.js";import{C as tr}from"../chunks/DkluvB59.js";import{U as ar}from"../chunks/DNG8nH_A.js";import{P as rr}from"../chunks/DkdU-WpC.js";import{W as _a}from"../chunks/DdSxRXu7.js";import{M as sr}from"../chunks/BMqEMhkr.js";import{B as or}from"../chunks/Cn38E2Ng.js";import{P as ir}from"../chunks/jw4NrPAd.js";function nr(q,_,L){var T=Ta(q,_);T&&T.set&&(q[_]=L,Fa(()=>{q[_]=null}))}function lr(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"12",cy:"5",r:"1"}],["circle",{cx:"12",cy:"19",r:"1"}]];vt(q,ct({name:"ellipsis-vertical"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function ha(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}],["path",{d:"M12 7v5l4 2"}]];vt(q,ct({name:"history"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function xa(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];vt(q,ct({name:"image"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function dr(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18"}],["path",{d:"m2.3 2.3 7.286 7.286"}],["circle",{cx:"11",cy:"11",r:"2"}]];vt(q,ct({name:"pen-tool"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function cr(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}]];vt(q,ct({name:"pen"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function vr(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];vt(q,ct({name:"send"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}function ur(q,_){const L=dt(_,["children","$$slots","$$events","$$legacy"]);const T=[["circle",{cx:"8",cy:"21",r:"1"}],["circle",{cx:"19",cy:"21",r:"1"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"}]];vt(q,ct({name:"shopping-cart"},()=>L,{get iconNode(){return T},children:(Z,f)=>{var d=je(),c=g(d);ut(c,_,"default",{}),o(Z,d)},$$slots:{default:!0}}))}var fr=n('<div class="absolute inset-0 flex items-center justify-center pointer-events-none"><span class="text-surface-400 text-sm">Desenhe sua assinatura aqui</span></div>'),pr=n('<div class="space-y-2"><label class="block text-sm font-medium text-surface-700"> </label> <div class="relative border-2 border-dashed border-surface-300 rounded-xl bg-white overflow-hidden"><canvas class="w-full h-32 cursor-crosshair touch-none"></canvas> <!></div> <div class="flex gap-2 justify-end"><button type="button" class="px-3 py-1.5 text-sm text-surface-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition flex items-center gap-1"><!> Limpar</button> <button type="button"><!> Confirmar</button></div></div>');function ga(q,_){ta(_,!1);let L=jt(_,"label",8,"Assine aqui"),T=jt(_,"initialSignature",8,"");const Z=ba();let f=R(),d=null,c=!1,s=R(!1);$a(()=>{if(!e(f)||(d=e(f).getContext("2d"),!d))return;const z=e(f).getBoundingClientRect();if(la(f,e(f).width=z.width),la(f,e(f).height=z.height),d.strokeStyle="#1e40af",d.lineWidth=2,d.lineCap="round",d.lineJoin="round",T()){const b=new Image;b.onload=()=>{d?.drawImage(b,0,0),l(s,!0)},b.src=T()}});function Me(z){const b=e(f).getBoundingClientRect();return"touches"in z&&z.touches.length>0?{x:z.touches[0].clientX-b.left,y:z.touches[0].clientY-b.top}:"clientX"in z?{x:z.clientX-b.left,y:z.clientY-b.top}:{x:0,y:0}}function oe(z){if(z.preventDefault(),!d)return;c=!0;const{x:b,y:ne}=Me(z);d.beginPath(),d.moveTo(b,ne)}function A(z){if(!c||!d)return;z.preventDefault();const{x:b,y:ne}=Me(z);d.lineTo(b,ne),d.stroke(),l(s,!0)}function ue(){c=!1}function Pe(){!d||!e(f)||(d.clearRect(0,0,e(f).width,e(f).height),l(s,!1),Z("clear"))}function ie(){if(!e(f))return;const z=e(f).toDataURL("image/png");Z("save",z)}function D(){return e(f)?.toDataURL("image/png")||""}var Ee={getDataUrl:D};ea();var Ae=pr(),Fe=a(Ae),Le=a(Fe,!0);t(Fe);var Ke=r(Fe,2),fe=a(Ke);Wa(fe,z=>l(f,z),()=>e(f));var Ve=r(fe,2);{var nt=z=>{var b=fr();o(z,b)};u(Ve,z=>{e(s)||z(nt)})}t(Ke);var ft=r(Ke,2),tt=a(ft),gt=a(tt);ya(gt,{class:"w-4 h-4"}),p(),t(tt);var He=r(tt,2),bt=a(He);return xt(bt,{class:"w-4 h-4"}),p(),t(He),t(ft),t(Ae),S(()=>{m(Le,L()),He.disabled=!e(s),Ye(He,1,`px-4 py-1.5 text-sm rounded-lg transition flex items-center gap-1
        ${e(s)?"bg-brand-500 text-white hover:bg-brand-700":"bg-surface-200 text-surface-400 cursor-not-allowed"}`)}),Q("mousedown",fe,oe),Q("mousemove",fe,A),Q("mouseup",fe,ue),Q("mouseleave",fe,ue),Q("touchstart",fe,oe),Q("touchmove",fe,A),Q("touchend",fe,ue),Q("click",tt,Pe),Q("click",He,ie),o(q,Ae),nr(_,"getDataUrl",D),aa(Ee)}var mr=n("<div></div>"),_r=n('<div class="flex-1 relative"><div><div><!></div> <span class="hidden sm:inline"> </span></div> <!></div>'),hr=n('<div class="space-y-4"><div class="flex justify-between items-center"><h3 class="font-bold text-lg">Relatório Técnico</h3> <button class="btn btn-secondary text-sm">Gerar Automático</button></div> <textarea class="input min-h-[200px]" placeholder="Descreva o serviço realizado, peças utilizadas, observações..."></textarea></div>'),xr=n('<!> <span class="text-surface-500">Enviando...</span>',1),gr=n('<!> <span class="text-surface-500">Clique para adicionar fotos</span>',1),br=n('<div class="relative group aspect-square"><img class="w-full h-full object-cover rounded-lg"/> <button class="absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition"><!></button></div>'),$r=n('<div class="grid grid-cols-3 gap-3"></div>'),wr=n('<div class="space-y-4"><h3 class="font-bold text-lg">Fotos do Serviço</h3> <p class="text-surface-500 text-sm">Adicione fotos do serviço realizado (opcional)</p> <label class="border-2 border-dashed border-surface-300 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:border-brand-400 hover:bg-brand-50/50 transition"><input type="file" class="hidden" accept="image/*" multiple/> <!></label> <!></div>'),yr=n('<label class="flex items-center gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-xl cursor-pointer"><input type="checkbox" class="rounded"/> <div><p class="font-medium text-yellow-800">Ignorar assinaturas (Admin)</p> <p class="text-sm text-yellow-600">Concluir sem coletar assinaturas</p></div></label>'),kr=n(`<p class="text-xs text-green-600 mt-1 flex items-center gap-1"><!> Assinatura
                                            capturada</p>`),Pr=n(`<p class="text-xs text-green-600 mt-1 flex items-center gap-1"><!> Assinatura
                                            capturada</p>`),Sr=n('<div class="grid gap-6"><div><!> <!></div> <div><!> <!></div></div>'),Cr=n('<div class="space-y-6"><h3 class="font-bold text-lg">Assinaturas</h3> <!> <!></div>'),Nr=n('<span class="text-yellow-600">Ignoradas (Admin)</span>'),Dr=n('<div class="space-y-4"><h3 class="font-bold text-lg">Resumo</h3> <div class="bg-surface-50 rounded-xl p-4 space-y-3"><div class="flex justify-between"><span class="text-surface-500">OS</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Cliente</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Valor</span> <span class="font-bold text-brand-600"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Fotos</span> <span class="font-medium"> </span></div> <div class="flex justify-between"><span class="text-surface-500">Assinaturas</span> <span class="font-medium"><!></span></div></div> <label class="flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-xl cursor-pointer"><input type="checkbox" class="rounded"/> <div><p class="font-medium text-green-800">Confirmar recebimento</p> <p class="text-sm text-green-600">O pagamento foi recebido pelo serviço</p></div></label></div>'),zr=n("<!> Finalizando...",1),jr=n("<!> Concluir Serviço",1),Ar=n('<button class="btn btn-primary"><!></button>'),Ir=n("<button>Próximo <!></button>"),Rr=n('<div class="fixed inset-0 z-50 flex items-center justify-center p-4"><div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div> <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden"><div class="bg-gradient-to-r from-brand-600 to-brand-700 text-white p-6"><div class="flex justify-between items-start"><div><h2 class="text-xl font-bold">Concluir Serviço</h2> <p class="text-brand-100 text-sm mt-1"> </p></div> <button class="p-2 hover:bg-white/10 rounded-xl transition"><!></button></div> <div class="flex gap-2 mt-6"></div></div> <div class="p-6 max-h-[50vh] overflow-y-auto"><!> <!> <!> <!></div> <div class="border-t p-4 flex justify-between"><button><!> Voltar</button> <!></div></div></div>');function Er(q,_){ta(_,!1);const L=R();let T=jt(_,"isOpen",8,!1),Z=jt(_,"isAdmin",8,!1),f=jt(_,"initialData",24,()=>({}));const d=ba();let c=R(0),s=R(!1),Me=R(!1),oe=R(""),A=R([]),ue=R(null),Pe=R(null),ie=R(!1),D=R(!1);const Ee=[{id:"report",title:"Relatório",icon:Ma},{id:"photos",title:"Fotos",icon:ka},{id:"signatures",title:"Assinaturas",icon:dr},{id:"confirm",title:"Confirmar",icon:xt}];function Ae(){d("close"),Fe()}function Fe(){l(c,0),l(oe,""),l(A,[]),l(ue,null),l(Pe,null),l(ie,!1),l(D,!1)}function Le(){e(c)<Ee.length-1&&da(c)}function Ke(){e(c)>0&&da(c,-1)}async function fe(b){const ne=b.target;if(!(!ne.files||ne.files.length===0)){l(Me,!0);try{const Ge=Array.from(ne.files);for(const pt of Ge){const Xe=new FileReader,Ze=await new Promise(lt=>{Xe.onloadend=()=>lt(Xe.result),Xe.readAsDataURL(pt)});l(A,[...e(A),Ze])}}catch(Ge){console.error("Erro no upload:",Ge)}finally{l(Me,!1),ne.value=""}}}function Ve(b){l(A,e(A).filter((ne,Ge)=>Ge!==b))}function nt(b){l(ue,b.detail)}function ft(b){l(Pe,b.detail)}async function tt(){l(s,!0);try{const b={technicalReport:e(oe),photos:e(A),techSignature:e(D)?null:e(ue),clientSignature:e(D)?null:e(Pe),adminBypass:e(D),paymentConfirmed:e(ie)};d("complete",b),Ae()}catch(b){console.error("Erro ao finalizar:",b)}finally{l(s,!1)}}function gt(){l(oe,`Relatório Técnico - OS #${f().osDisplayNumber||"N/A"}
Cliente: ${f().clienteNome||"N/A"}
Data: ${new Date().toLocaleDateString("pt-BR")}

Descrição do Serviço:
${f().descricao||f().titulo||"Serviço concluído com êxito."}

Valor Total: R$ ${(f().valorTotal||0).toFixed(2)}

Observações:
- Serviço executado conforme solicitação
- Equipamento em pleno funcionamento
- Cliente orientado sobre uso adequado`)}Yt(()=>(e(oe),e(D),e(ue),e(Pe),e(c)),()=>{l(L,{0:e(oe).trim().length>10,1:!0,2:e(D)||e(ue)&&e(Pe),3:!0}[e(c)]??!1)}),wa(),ea();var He=je(),bt=g(He);{var z=b=>{var ne=Rr(),Ge=a(ne),pt=r(Ge,2),Xe=a(pt),Ze=a(Xe),lt=a(Ze),Rt=r(a(lt),2),qt=a(Rt);t(Rt),t(lt);var $t=r(lt,2),Wt=a($t);fa(Wt,{class:"w-5 h-5"}),t($t),t(Ze);var v=r(Ze,2);At(v,5,()=>Ee,It,(E,h,j)=>{var ae=_r(),re=a(ae),W=a(re),M=a(W);{var ee=V=>{xt(V,{class:"w-4 h-4"})},he=V=>{var xe=je(),Te=g(xe);qa(Te,()=>e(h).icon,(de,we)=>{we(de,{class:"w-4 h-4"})}),o(V,xe)};u(M,V=>{j<e(c)?V(ee):V(he,!1)})}t(W);var O=r(W,2),le=a(O,!0);t(O),t(re);var Se=r(re,2);{var Oe=V=>{var xe=mr();S(()=>Ye(xe,1,`absolute top-4 left-10 right-0 h-0.5 ${j<e(c)?"bg-white":"bg-brand-500/30"}`)),o(V,xe)};u(Se,V=>{i(()=>j<Ee.length-1)&&V(Oe)})}t(ae),S(()=>{Ye(re,1,`flex items-center gap-2 text-xs font-medium ${j<=e(c)?"text-white":"text-brand-200"}`),Ye(W,1,`w-8 h-8 rounded-full flex items-center justify-center ${j<e(c)?"bg-white text-brand-600":j===e(c)?"bg-white/20 border-2 border-white":"bg-brand-500/30"}`),m(le,(e(h),i(()=>e(h).title)))}),o(E,ae)}),t(v),t(Xe);var $=r(Xe,2),_e=a($);{var at=E=>{var h=hr(),j=a(h),ae=r(a(j),2);t(j);var re=r(j,2);Kt(re),t(h),Q("click",ae,gt),Zt(re,()=>e(oe),W=>l(oe,W)),o(E,h)};u(_e,E=>{e(c)===0&&E(at)})}var Je=r(_e,2);{var mt=E=>{var h=wr(),j=r(a(h),4),ae=a(j),re=r(ae,2);{var W=O=>{var le=xr(),Se=g(le);pa(Se,{class:"w-8 h-8 text-brand-500 animate-spin mb-2"}),p(2),o(O,le)},M=O=>{var le=gr(),Se=g(le);Va(Se,{class:"w-8 h-8 text-surface-400 mb-2"}),p(2),o(O,le)};u(re,O=>{e(Me)?O(W):O(M,!1)})}t(j);var ee=r(j,2);{var he=O=>{var le=$r();At(le,5,()=>e(A),It,(Se,Oe,V)=>{var xe=br(),Te=a(xe);it(Te,"alt",`Foto ${V+1}`);var de=r(Te,2),we=a(de);fa(we,{class:"w-3 h-3"}),t(de),t(xe),S(()=>it(Te,"src",e(Oe))),Q("click",de,()=>Ve(V)),o(Se,xe)}),t(le),o(O,le)};u(ee,O=>{e(A),i(()=>e(A).length>0)&&O(he)})}t(h),S(()=>ae.disabled=e(Me)),Q("change",ae,fe),o(E,h)};u(Je,E=>{e(c)===1&&E(mt)})}var rt=r(Je,2);{var Et=E=>{var h=Cr(),j=r(a(h),2);{var ae=M=>{var ee=yr(),he=a(ee);va(he),p(2),t(ee),ua(he,()=>e(D),O=>l(D,O)),o(M,ee)};u(j,M=>{Z()&&M(ae)})}var re=r(j,2);{var W=M=>{var ee=Sr(),he=a(ee),O=a(he);ga(O,{label:"Assinatura do Técnico",$$events:{save:nt}});var le=r(O,2);{var Se=de=>{var we=kr(),st=a(we);xt(st,{class:"w-3 h-3"}),p(),t(we),o(de,we)};u(le,de=>{e(ue)&&de(Se)})}t(he);var Oe=r(he,2),V=a(Oe);ga(V,{label:"Assinatura do Cliente",$$events:{save:ft}});var xe=r(V,2);{var Te=de=>{var we=Pr(),st=a(we);xt(st,{class:"w-3 h-3"}),p(),t(we),o(de,we)};u(xe,de=>{e(Pe)&&de(Te)})}t(Oe),t(ee),o(M,ee)};u(re,M=>{e(D)||M(W)})}t(h),o(E,h)};u(rt,E=>{e(c)===2&&E(Et)})}var wt=r(rt,2);{var Ot=E=>{var h=Dr(),j=r(a(h),2),ae=a(j),re=r(a(ae),2),W=a(re);t(re),t(ae);var M=r(ae,2),ee=r(a(M),2),he=a(ee,!0);t(ee),t(M);var O=r(M,2),le=r(a(O),2),Se=a(le);t(le),t(O);var Oe=r(O,2),V=r(a(Oe),2),xe=a(V);t(V),t(Oe);var Te=r(Oe,2),de=r(a(Te),2),we=a(de);{var st=Ce=>{var ot=Nr();o(Ce,ot)},Vt=Ce=>{var ot=ze();S(()=>m(ot,e(ue)&&e(Pe)?"✅ Coletadas":"⚠️ Pendentes")),o(Ce,ot)};u(we,Ce=>{e(D)?Ce(st):Ce(Vt,!1)})}t(de),t(Te),t(j);var kt=r(j,2),Pt=a(kt);va(Pt),p(2),t(kt),t(h),S(Ce=>{m(W,`#${Bt(f()),i(()=>f().osDisplayNumber||"N/A")??""}`),m(he,(Bt(f()),i(()=>f().clienteNome||"N/A"))),m(Se,`R$ ${Ce??""}`),m(xe,`${e(A),i(()=>e(A).length)??""} foto(s)`)},[()=>(Bt(f()),i(()=>(f().valorTotal||0).toFixed(2)))]),ua(Pt,()=>e(ie),Ce=>l(ie,Ce)),o(E,h)};u(wt,E=>{e(c)===3&&E(Ot)})}t($);var yt=r($,2),et=a(yt),Tt=a(et);Ga(Tt,{class:"w-4 h-4"}),p(),t(et);var Mt=r(et,2);{var Ft=E=>{var h=Ar(),j=a(h);{var ae=W=>{var M=zr(),ee=g(M);pa(ee,{class:"w-4 h-4 animate-spin"}),p(),o(W,M)},re=W=>{var M=jr(),ee=g(M);xt(ee,{class:"w-4 h-4"}),p(),o(W,M)};u(j,W=>{e(s)?W(ae):W(re,!1)})}t(h),S(()=>h.disabled=e(s)),Q("click",h,tt),o(E,h)},Lt=E=>{var h=Ir(),j=r(a(h));Xa(j,{class:"w-4 h-4"}),t(h),S(()=>{h.disabled=!e(L),Ye(h,1,`btn btn-primary ${e(L)?"":"opacity-50 cursor-not-allowed"}`)}),Q("click",h,Le),o(E,h)};u(Mt,E=>{e(c),i(()=>e(c)===Ee.length-1)?E(Ft):E(Lt,!1)})}t(yt),t(pt),t(ne),S(()=>{m(qt,`OS #${Bt(f()),i(()=>f().osDisplayNumber||"N/A")??""}`),et.disabled=e(c)===0,Ye(et,1,`btn btn-secondary ${e(c)===0?"opacity-50 cursor-not-allowed":""}`)}),Q("click",Ge,Ae),Q("click",$t,Ae),Q("click",et,Ke),o(b,ne)};u(bt,b=>{T()&&b(z)})}o(q,He),aa()}var Or=n('<div class="p-12 text-center"><!></div>'),Tr=n('<div class="flex items-center gap-2 text-brand-600 font-black"><!> </div>'),Fr=n("<!> PDF",1),Lr=n("<!> Salvar",1),Ur=n("<!> Editar",1),Br=n('<textarea class="w-full min-h-[160px] p-4 bg-surface-50 border border-surface-200 rounded-2xl outline-none focus:border-brand-500 transition-all font-medium" placeholder="Descreva o problema..."></textarea>'),qr=n('<div class="text-surface-700 leading-relaxed font-medium whitespace-pre-wrap text-lg"> </div>'),Wr=n('<div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black uppercase tracking-widest text-surface-400">Descrição Detalhada</h3> <!></div> <!>',1),Mr=n('<h4 class="font-black text-blue-900 mb-4 flex items-center gap-2"><!> Equipamento</h4> <p class="text-blue-800 font-bold"><!></p>',1),Vr=n('<h4 class="font-black text-brand-900 mb-4 flex items-center gap-2"><!> Localização</h4> <p class="text-brand-800 font-bold"> </p>',1),Hr=n('<div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">CNPJ</p> <p class="font-bold"> </p></div>'),Gr=n('<div class="space-y-4"><div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">Endereço</p> <p class="font-bold leading-relaxed"> <!> <br/> <br/> </p></div></div>'),Xr=n('<div class="flex items-center gap-3 mb-6"><!> <h3 class="text-sm font-black uppercase tracking-widest text-brand-400">Dados da Empresa (Emissor)</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="space-y-4"><div><p class="text-[10px] font-black uppercase tracking-widest text-surface-400 mb-1">Nome Fantasia</p> <p class="text-xl font-black"> </p></div> <!></div> <!></div>',1),Jr=n('<div class="space-y-8"><!> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <!></div> <!></div>'),Qr=n(`<!> Adicionar
                                            Item`,1),Yr=n('<div class="bg-surface-50 p-6 rounded-2xl border border-surface-200 space-y-4 mb-8"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div class="md:col-span-2"><!></div> <!> <!></div> <!></div>'),Kr=n('<th class="p-4 w-16"></th>'),Zr=n('<td class="p-4 text-center"><button class="text-red-400 hover:text-red-600 transition-colors"><!></button></td>'),es=n('<tr class="hover:bg-surface-50/50 transition-colors font-bold text-surface-700"><td class="p-4"> </td><td class="p-4 text-center"> </td><td class="p-4 text-right"> </td><td class="p-4 text-right text-surface-900"> </td><!></tr>'),ts=n('<tr><td class="p-12 text-center text-surface-400 font-medium italic">Nenhum item adicionado.</td></tr>'),as=n('<div class="flex justify-between items-center mb-8"><h3 class="text-xl font-black text-surface-900">Itens do Serviço</h3> <!></div> <!> <div class="border border-surface-200 rounded-2xl overflow-hidden"><table class="w-full text-sm"><thead class="bg-surface-50 text-surface-400 font-black uppercase tracking-widest text-[10px]"><tr><th class="p-4 text-left">Descrição</th><th class="p-4 text-center">Qtd</th><th class="p-4 text-right">Unitário</th><th class="p-4 text-right">Total</th><!></tr></thead><tbody class="divide-y divide-surface-100"></tbody><tfoot class="bg-surface-900 text-white"><tr><td class="p-6 text-right font-black uppercase tracking-widest text-xs">Total Geral</td><td class="p-6 text-right text-2xl font-black"> </td></tr></tfoot></table></div> <!>',1),rs=n('<h4 class="font-black text-brand-900 mb-6 flex items-center gap-3"><!> Diário de Obra</h4> <div class="flex gap-4"><textarea class="flex-1 bg-white border border-surface-200 p-4 rounded-2xl text-sm font-medium outline-none focus:border-brand-500 transition-all" placeholder="Descreva a atividade realizada agora..." rows="2"></textarea> <!></div>',1),ss=n('<img class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"/> <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><!></div>',1),os=n('<div class="col-span-full py-20 text-center border-2 border-dashed border-surface-200 rounded-3xl"><!> <p class="text-surface-400 font-bold">Nenhuma foto registrada ainda.</p></div>'),is=n('<div class="space-y-8"><!> <div class="grid grid-cols-2 md:grid-cols-3 gap-4"></div></div>'),ns=n('<div class="absolute left-[11px] top-8 bottom-0 w-0.5 bg-surface-100"></div>'),ls=n('<div class="relative pl-8 pb-8 last:pb-0"><!> <div class="absolute left-0 top-1.5 w-6 h-6 rounded-full bg-brand-50 border-4 border-white shadow-sm flex items-center justify-center"><div class="w-1.5 h-1.5 rounded-full bg-brand-600"></div></div> <div><div class="flex items-center gap-3 mb-2"><span class="text-xs font-black text-surface-400 uppercase tracking-widest"> </span> <!></div> <p class="text-surface-700 font-bold leading-relaxed"> </p></div></div>'),ds=n('<div class="text-center py-12"><!> <p class="text-surface-400 font-bold">Nenhum registro no histórico.</p></div>'),cs=n('<div class="space-y-8"></div>'),vs=n('<h3 class="font-black text-lg mb-6 flex items-center gap-2"><!> Status do Serviço</h3> <div class="space-y-3"><!> <!> <!> <!></div>',1),us=n('<div><p class="text-[10px] font-black text-surface-400 uppercase tracking-widest mb-1">Contato</p> <a class="flex items-center gap-2 text-brand-600 font-black hover:underline"><!> </a></div>'),fs=n('<h3 class="font-black text-surface-900 mb-6 flex items-center gap-2"><!> Cliente</h3> <div class="space-y-4"><div><p class="text-[10px] font-black text-surface-400 uppercase tracking-widest mb-1">Nome</p> <p class="font-bold text-surface-900"> </p></div> <!></div>',1),ps=n('<h3 class="font-black text-surface-900 mb-6 flex items-center gap-2"><!> Responsável</h3> <div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-surface-100 flex items-center justify-center font-black text-surface-600"> </div> <p class="font-bold text-surface-900"> </p></div>',1),ms=n('<div class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-surface-200 px-4 py-3"><div class="max-w-7xl mx-auto flex items-center justify-between"><div class="flex items-center gap-4"><!> <div><div class="flex items-center gap-2"><!> <!></div></div></div> <div class="flex items-center gap-2"><!> <!></div></div></div> <div class="bg-white border-b border-surface-200"><div class="max-w-7xl mx-auto px-4 py-8"><div class="flex flex-col md:flex-row justify-between items-start gap-6"><div class="space-y-4 flex-1"><h1 class="text-4xl font-black text-surface-900 tracking-tight leading-tight"> </h1> <div class="flex flex-wrap items-center gap-6 text-sm font-medium text-surface-500"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-full bg-brand-50 flex items-center justify-center text-brand-600 font-black"> </div> <span class="text-surface-900 font-bold"> </span></div> <div class="flex items-center gap-2"><!> </div> <!></div></div> <div class="flex gap-3 w-full md:w-auto"><!></div></div></div></div> <div class="max-w-7xl mx-auto px-4 py-8"><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2 space-y-8"><div class="flex gap-2 p-1.5 bg-surface-100/50 rounded-2xl border border-surface-200 overflow-x-auto no-scrollbar svelte-zlgf0w"><button><!> Visão Geral</button> <button><!> Itens</button> <button><!> Fotos</button> <button><!> Histórico</button></div> <div class="animate-in fade-in slide-in-from-bottom-4 duration-500"><!></div></div> <div class="space-y-6"><!> <!> <!></div></div></div>',1),_s=n('<div class="fixed inset-0 z-[100] flex items-center justify-center p-4"><div class="absolute inset-0 bg-surface-900/60 backdrop-blur-md"></div> <div class="relative w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-white rounded-3xl shadow-2xl"><!></div></div>'),hs=n('<div class="min-h-screen bg-surface-50 pb-24"><!></div> <!>',1);function Ys(q,_){ta(_,!1);const L=()=>ca(Ua,"$page",Z),T=()=>ca(Ja,"$user",Z),[Z,f]=La(),d=R(),c=R();let s=R(null),Me=R(!0),oe=R(!1),A=R("overview"),ue=R(!1),Pe=R(""),ie=R(!1),D=R([]),Ee=R(""),Ae=R(1),Fe=R(0),Le=R("");async function Ke(){try{const v=localStorage.getItem("token"),$=await fetch(`/api/solicitacoes/${e(d)}`,{headers:{Authorization:`Bearer ${v}`}});$.ok&&(l(s,await $.json()),l(D,[...e(s)?.itens_os||[]]))}catch(v){console.error("Erro ao carregar OS:",v)}finally{l(Me,!1)}}async function fe(v){l(oe,!0);try{const $=localStorage.getItem("token");await fetch(`/api/solicitacoes/${e(d)}`,{method:"PUT",headers:{Authorization:`Bearer ${$}`,"Content-Type":"application/json"},body:JSON.stringify(v)}),await Ke()}catch($){console.error("Erro ao atualizar:",$)}finally{l(oe,!1)}}let Ve=R(!1);async function nt(v){if(v==="concluido"){l(Ve,!0);return}await fe({status:v})}async function ft(v){const $=v.detail,_e={status:"concluido",technical_report:$.technicalReport,fotos:[...e(s)?.fotos||[],...$.photos.map(Je=>({url:Je}))]},at={data:new Date().toISOString(),descricao:`Serviço concluído via Wizard. Pagamento ${$.paymentConfirmed?"confirmado":"pendente"}.`,usuario:T()?.nome_completo||"Usuário"};_e.historico=[...e(s)?.historico||[],at],await fe(_e),l(Ve,!1)}async function tt(){await fe({descricao_detalhada:e(Pe)}),l(ue,!1)}function gt(){if(!e(Ee).trim())return;const v=e(Ae)*e(Fe);l(D,[...e(D),{descricao:e(Ee),quantidade:e(Ae),valor_unitario:e(Fe),valor_total:v}]),l(Ee,""),l(Ae,1),l(Fe,0)}function He(v){l(D,e(D).filter(($,_e)=>_e!==v))}async function bt(){const v=e(D).reduce(($,_e)=>$+_e.valor_total,0);await fe({itens_os:e(D),valor_total:v,orcamento_disponivel:!0}),l(ie,!1)}async function z(){if(!e(Le).trim())return;const v={data:new Date().toISOString(),descricao:`[Diário de Obra] ${e(Le)}`,usuario:"Técnico"},$=e(s)?.historico||[];await fe({historico:[...$,v]}),l(Le,"")}function b(v){return new Date(v).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}function ne(v){return v.toLocaleString("pt-BR",{minimumFractionDigits:2})}function Ge(v){return{pendente:"warning",agendado:"info",em_andamento:"brand",concluido:"success",faturado:"success",cancelado:"danger"}[v]||"neutral"}function pt(){const v=localStorage.getItem("token");window.open(`/api/solicitacoes/${e(d)}/pdf?token=${v}`,"_blank")}$a(()=>{Ke()}),Yt(()=>L(),()=>{l(d,L().params.id)}),Yt(()=>e(D),()=>{l(c,e(D).reduce((v,$)=>v+$.valor_total,0))}),wa(),ea();var Xe=hs(),Ze=g(Xe),lt=a(Ze);{var Rt=v=>{var $=Or(),_e=a($);ma(_e,{class:"w-12 h-12 animate-spin mx-auto text-brand-500 opacity-20"}),t($),o(v,$)},qt=v=>{var $=je(),_e=g($);{var at=Je=>{var mt=ms(),rt=g(mt),Et=a(rt),wt=a(Et),Ot=a(wt);De(Ot,{variant:"ghost",size:"sm",className:"p-2",$$events:{click:()=>Ba("/solicitacoes")},children:(w,H)=>{Qa(w,{class:"w-5 h-5"})},$$slots:{default:!0}});var yt=r(Ot,2),et=a(yt),Tt=a(et);Qt(Tt,{variant:"neutral",size:"sm",className:"bg-surface-900 text-white border-none",children:(w,H)=>{p();var G=ze();S(()=>m(G,`OS #${e(s),i(()=>e(s).sequential_id)??""}`)),o(w,G)},$$slots:{default:!0}});var Mt=r(Tt,2);{let w=ht(()=>(e(s),i(()=>Ge(e(s).status))));Qt(Mt,{get variant(){return e(w)},children:(H,G)=>{p();var X=ze();S(ge=>m(X,ge),[()=>(e(s),i(()=>e(s).status.replace("_"," ")))]),o(H,X)},$$slots:{default:!0}})}t(et),t(yt),t(wt);var Ft=r(wt,2),Lt=a(Ft);De(Lt,{variant:"secondary",size:"sm",get loading(){return e(oe)},$$events:{click:Ke},children:(w,H)=>{{let G=ht(()=>e(oe)?"animate-spin":"");ma(w,{get class(){return`w-4 h-4 ${e(G)??""}`}})}},$$slots:{default:!0}});var E=r(Lt,2);De(E,{variant:"secondary",size:"sm",children:(w,H)=>{lr(w,{class:"w-4 h-4"})},$$slots:{default:!0}}),t(Ft),t(Et),t(rt);var h=r(rt,2),j=a(h),ae=a(j),re=a(ae),W=a(re),M=a(W,!0);t(W);var ee=r(W,2),he=a(ee),O=a(he),le=a(O,!0);t(O);var Se=r(O,2),Oe=a(Se,!0);t(Se),t(he);var V=r(he,2),xe=a(V);Ya(xe,{class:"w-4 h-4 text-surface-400"});var Te=r(xe);t(V);var de=r(V,2);{var we=w=>{var H=Tr(),G=a(H);Za(G,{class:"w-4 h-4"});var X=r(G);t(H),S(ge=>m(X,` R$ ${ge??""}`),[()=>(e(s),i(()=>ne(e(s).valor_total)))]),o(w,H)};u(de,w=>{e(s),i(()=>e(s).valor_total)&&w(we)})}t(ee),t(re);var st=r(re,2),Vt=a(st);De(Vt,{variant:"secondary",className:"flex-1 md:flex-none border-surface-200",$$events:{click:pt},children:(w,H)=>{var G=Fr(),X=g(G);Ka(X,{class:"w-4 h-4 mr-2"}),p(),o(w,G)},$$slots:{default:!0}}),t(st),t(ae),t(j),t(h);var kt=r(h,2),Pt=a(kt),Ce=a(Pt),ot=a(Ce),St=a(ot),Pa=a(St);er(Pa,{class:"w-4 h-4"}),p(),t(St);var Ct=r(St,2),Sa=a(Ct);ur(Sa,{class:"w-4 h-4"}),p(),t(Ct);var Nt=r(Ct,2),Ca=a(Nt);xa(Ca,{class:"w-4 h-4"}),p(),t(Nt);var Ut=r(Nt,2),Na=a(Ut);ha(Na,{class:"w-4 h-4"}),p(),t(Ut),t(ot);var ra=r(ot,2),Da=a(ra);{var za=w=>{var H=Jr(),G=a(H);We(G,{padding:"p-8",children:(te,pe)=>{var F=Wr(),y=g(F),Y=r(a(y),2);De(Y,{variant:"ghost",size:"sm",$$events:{click:()=>{e(ue)?tt():(l(Pe,e(s)?.descricao_detalhada||""),l(ue,!0))}},children:(P,C)=>{var K=je(),U=g(K);{var ce=se=>{var J=Lr(),ve=g(J);Ha(ve,{class:"w-4 h-4 mr-2"}),p(),o(se,J)},ye=se=>{var J=Ur(),ve=g(J);cr(ve,{class:"w-4 h-4 mr-2"}),p(),o(se,J)};u(U,se=>{e(ue)?se(ce):se(ye,!1)})}o(P,K)},$$slots:{default:!0}}),t(y);var x=r(y,2);{var k=P=>{var C=Br();Kt(C),Zt(C,()=>e(Pe),K=>l(Pe,K)),o(P,C)},N=P=>{var C=qr(),K=a(C,!0);t(C),S(()=>m(K,(e(s),i(()=>e(s).descricao_detalhada||"Sem descrição detalhada.")))),o(P,C)};u(x,P=>{e(ue)?P(k):P(N,!1)})}o(te,F)},$$slots:{default:!0}});var X=r(G,2),ge=a(X);We(ge,{padding:"p-6",className:"bg-blue-50/50 border-blue-100",children:(te,pe)=>{var F=Mr(),y=g(F),Y=a(y);_a(Y,{class:"w-5 h-5"}),p(),t(y);var x=r(y,2),k=a(x);{var N=C=>{var K=ze();S(()=>m(K,`${e(D),i(()=>e(D).length)??""} item(ns) vinculado(s)`)),o(C,K)},P=C=>{var K=ze("Nenhum equipamento vinculado.");o(C,K)};u(k,C=>{e(D),i(()=>e(D).length>0)?C(N):C(P,!1)})}t(x),o(te,F)},$$slots:{default:!0}});var be=r(ge,2);We(be,{padding:"p-6",className:"bg-brand-50/50 border-brand-100",children:(te,pe)=>{var F=Vr(),y=g(F),Y=a(y);sr(Y,{class:"w-5 h-5"}),p(),t(y);var x=r(y,2),k=a(x,!0);t(x),S(()=>m(k,(e(s),i(()=>e(s).local?.address||"Endereço não cadastrado")))),o(te,F)},$$slots:{default:!0}}),t(X);var $e=r(X,2);{var Ie=te=>{We(te,{padding:"p-8",className:"bg-surface-900 text-white",children:(pe,F)=>{var y=Xr(),Y=g(y),x=a(Y);or(x,{class:"w-6 h-6 text-brand-400"}),p(2),t(Y);var k=r(Y,2),N=a(k),P=a(N),C=r(a(P),2),K=a(C,!0);t(C),t(P);var U=r(P,2);{var ce=J=>{var ve=Hr(),Re=r(a(ve),2),Qe=a(Re,!0);t(Re),t(ve),S(()=>m(Qe,(e(s),i(()=>e(s).empresa.cnpj)))),o(J,ve)};u(U,J=>{e(s),i(()=>e(s).empresa.cnpj)&&J(ce)})}t(N);var ye=r(N,2);{var se=J=>{var ve=Gr(),Re=a(ve),Qe=r(a(Re),2),B=a(Qe),I=r(B);{var Ne=Ue=>{var Be=ze();S(()=>m(Be,`- ${e(s),i(()=>e(s).empresa.endereco.complemento)??""}`)),o(Ue,Be)};u(I,Ue=>{e(s),i(()=>e(s).empresa.endereco.complemento)&&Ue(Ne)})}var me=r(I,3),ke=r(me,2);t(Qe),t(Re),t(ve),S(()=>{m(B,`${e(s),i(()=>e(s).empresa.endereco.logradouro)??""}, ${e(s),i(()=>e(s).empresa.endereco.numero)??""} `),m(me,` ${e(s),i(()=>e(s).empresa.endereco.bairro)??""} - ${e(s),i(()=>e(s).empresa.endereco.cidade)??""}/${e(s),i(()=>e(s).empresa.endereco.estado)??""} `),m(ke,` CEP: ${e(s),i(()=>e(s).empresa.endereco.cep)??""}`)}),o(J,ve)};u(ye,J=>{e(s),i(()=>e(s).empresa.endereco)&&J(se)})}t(k),S(()=>m(K,(e(s),i(()=>e(s).empresa.nome_fantasia)))),o(pe,y)},$$slots:{default:!0}})};u($e,te=>{e(s),i(()=>e(s).empresa)&&te(Ie)})}t(H),o(w,H)},ja=w=>{var H=je(),G=g(H);{var X=be=>{We(be,{padding:"p-8",children:($e,Ie)=>{var te=as(),pe=g(te),F=r(a(pe),2);{let B=ht(()=>e(ie)?"danger":"secondary");De(F,{get variant(){return e(B)},size:"sm",$$events:{click:()=>l(ie,!e(ie))},children:(I,Ne)=>{p();var me=ze();S(()=>m(me,e(ie)?"Cancelar":"Editar Itens")),o(I,me)},$$slots:{default:!0}})}t(pe);var y=r(pe,2);{var Y=B=>{var I=Yr(),Ne=a(I),me=a(Ne),ke=a(me);Jt(ke,{label:"Descrição",placeholder:"Ex: Carga de Gás",get value(){return e(Ee)},set value(qe){l(Ee,qe)},$$legacy:!0}),t(me);var Ue=r(me,2);Jt(Ue,{label:"Qtd",type:"number",get value(){return e(Ae)},set value(qe){l(Ae,qe)},$$legacy:!0});var Be=r(Ue,2);Jt(Be,{label:"Preço Unit.",type:"number",get value(){return e(Fe)},set value(qe){l(Fe,qe)},$$legacy:!0}),t(Ne);var Ht=r(Ne,2);De(Ht,{variant:"primary",fullWidth:!0,$$events:{click:gt},children:(qe,na)=>{var _t=Qr(),Gt=g(_t);ir(Gt,{class:"w-4 h-4 mr-2"}),p(),o(qe,_t)},$$slots:{default:!0}}),t(I),o(B,I)};u(y,B=>{e(ie)&&B(Y)})}var x=r(y,2),k=a(x),N=a(k),P=a(N),C=r(a(P),4);{var K=B=>{var I=Kr();o(B,I)};u(C,B=>{e(ie)&&B(K)})}t(P),t(N);var U=r(N);At(U,5,()=>e(D),It,(B,I,Ne)=>{var me=es(),ke=a(me),Ue=a(ke,!0);t(ke);var Be=r(ke),Ht=a(Be,!0);t(Be);var qe=r(Be),na=a(qe);t(qe);var _t=r(qe),Gt=a(_t);t(_t);var Ra=r(_t);{var Ea=Dt=>{var zt=Zr(),Xt=a(zt),Oa=a(Xt);ya(Oa,{class:"w-4 h-4"}),t(Xt),t(zt),Q("click",Xt,()=>He(Ne)),o(Dt,zt)};u(Ra,Dt=>{e(ie)&&Dt(Ea)})}t(me),S((Dt,zt)=>{m(Ue,(e(I),i(()=>e(I).descricao))),m(Ht,(e(I),i(()=>e(I).quantidade))),m(na,`R$ ${Dt??""}`),m(Gt,`R$ ${zt??""}`)},[()=>(e(I),i(()=>ne(e(I).valor_unitario))),()=>(e(I),i(()=>ne(e(I).valor_total)))]),o(B,me)},B=>{var I=ts(),Ne=a(I);t(I),S(()=>it(Ne,"colspan",e(ie)?5:4)),o(B,I)}),t(U);var ce=r(U),ye=a(ce),se=a(ye),J=r(se),ve=a(J);t(J),t(ye),t(ce),t(k),t(x);var Re=r(x,2);{var Qe=B=>{De(B,{variant:"primary",fullWidth:!0,className:"mt-8 py-4 text-lg",get loading(){return e(oe)},$$events:{click:bt},children:(I,Ne)=>{p();var me=ze("Salvar Orçamento");o(I,me)},$$slots:{default:!0}})};u(Re,B=>{e(ie)&&B(Qe)})}S(B=>{it(se,"colspan",e(ie)?3:2),it(J,"colspan",(e(ie),2)),m(ve,`R$ ${B??""}`)},[()=>(e(c),i(()=>ne(e(c))))]),o($e,te)},$$slots:{default:!0}})},ge=be=>{var $e=je(),Ie=g($e);{var te=F=>{var y=is(),Y=a(y);We(Y,{padding:"p-8",className:"bg-brand-50/30 border-brand-100",children:(k,N)=>{var P=rs(),C=g(P),K=a(C);ka(K,{class:"w-6 h-6"}),p(),t(C);var U=r(C,2),ce=a(U);Kt(ce);var ye=r(ce,2);{let se=ht(()=>(e(Le),i(()=>!e(Le).trim())));De(ye,{variant:"primary",get disabled(){return e(se)},className:"h-auto px-6",$$events:{click:z},children:(J,ve)=>{vr(J,{class:"w-5 h-5"})},$$slots:{default:!0}})}t(U),Zt(ce,()=>e(Le),se=>l(Le,se)),o(k,P)},$$slots:{default:!0}});var x=r(Y,2);At(x,5,()=>(e(s),i(()=>e(s).fotos||[])),It,(k,N,P)=>{We(k,{padding:"p-0",className:"aspect-square overflow-hidden group relative",children:(C,K)=>{var U=ss(),ce=g(U);it(ce,"alt",`Evidência ${P+1}`);var ye=r(ce,2),se=a(ye);De(se,{variant:"secondary",size:"sm",$$events:{click:()=>window.open(e(N).url,"_blank")},children:(J,ve)=>{p();var Re=ze("Ver Foto");o(J,Re)},$$slots:{default:!0}}),t(ye),S(()=>it(ce,"src",(e(N),i(()=>e(N).url)))),o(C,U)},$$slots:{default:!0}})},k=>{var N=os(),P=a(N);xa(P,{class:"w-16 h-16 text-surface-200 mx-auto mb-4"}),p(2),t(N),o(k,N)}),t(x),t(y),o(F,y)},pe=F=>{var y=je(),Y=g(y);{var x=k=>{We(k,{padding:"p-8",children:(N,P)=>{var C=cs();At(C,5,()=>(e(s),i(()=>e(s).historico||[])),It,(K,U,ce)=>{var ye=ls(),se=a(ye);{var J=ke=>{var Ue=ns();o(ke,Ue)};u(se,ke=>{e(s),i(()=>ce!==(e(s).historico?.length||0)-1)&&ke(J)})}var ve=r(se,4),Re=a(ve),Qe=a(Re),B=a(Qe,!0);t(Qe);var I=r(Qe,2);Qt(I,{variant:"neutral",size:"sm",children:(ke,Ue)=>{p();var Be=ze();S(()=>m(Be,(e(U),i(()=>e(U).usuario)))),o(ke,Be)},$$slots:{default:!0}}),t(Re);var Ne=r(Re,2),me=a(Ne,!0);t(Ne),t(ve),t(ye),S(ke=>{m(B,ke),m(me,(e(U),i(()=>e(U).descricao)))},[()=>(e(U),i(()=>b(e(U).data)))]),o(K,ye)},K=>{var U=ds(),ce=a(U);ha(ce,{class:"w-16 h-16 text-surface-100 mx-auto mb-4"}),p(2),t(U),o(K,U)}),t(C),o(N,C)},$$slots:{default:!0}})};u(Y,k=>{e(A)==="history"&&k(x)},!0)}o(F,y)};u(Ie,F=>{e(A)==="photos"?F(te):F(pe,!1)},!0)}o(be,$e)};u(G,be=>{e(A)==="services"?be(X):be(ge,!1)},!0)}o(w,H)};u(Da,w=>{e(A)==="overview"?w(za):w(ja,!1)})}t(ra),t(Ce);var sa=r(Ce,2),oa=a(sa);We(oa,{padding:"p-6",className:"bg-surface-900 text-white border-none shadow-2xl shadow-surface-200",children:(w,H)=>{var G=vs(),X=g(G),ge=a(X);tr(ge,{class:"w-5 h-5 text-brand-400"}),p(),t(X);var be=r(X,2),$e=a(be);{var Ie=x=>{De(x,{fullWidth:!0,variant:"primary",get loading(){return e(oe)},$$events:{click:()=>nt("agendado")},children:(k,N)=>{p();var P=ze("Agendar Visita");o(k,P)},$$slots:{default:!0}})};u($e,x=>{e(s),i(()=>e(s).status==="pendente")&&x(Ie)})}var te=r($e,2);{var pe=x=>{De(x,{fullWidth:!0,variant:"primary",get loading(){return e(oe)},$$events:{click:()=>nt("em_andamento")},children:(k,N)=>{p();var P=ze("Iniciar Serviço");o(k,P)},$$slots:{default:!0}})};u(te,x=>{e(s),i(()=>e(s).status==="agendado")&&x(pe)})}var F=r(te,2);{var y=x=>{De(x,{fullWidth:!0,variant:"success",get loading(){return e(oe)},$$events:{click:()=>nt("concluido")},children:(k,N)=>{p();var P=ze("Finalizar OS");o(k,P)},$$slots:{default:!0}})};u(F,x=>{e(s),i(()=>["pendente","agendado","em_andamento"].includes(e(s).status))&&x(y)})}var Y=r(F,2);De(Y,{fullWidth:!0,variant:"danger",className:"bg-white/10 text-white border-white/10 hover:bg-red-500/20",children:(x,k)=>{p();var N=ze("Cancelar Chamado");o(x,N)},$$slots:{default:!0}}),t(be),o(w,G)},$$slots:{default:!0}});var ia=r(oa,2);We(ia,{padding:"p-6",children:(w,H)=>{var G=fs(),X=g(G),ge=a(X);ar(ge,{class:"w-5 h-5 text-brand-600"}),p(),t(X);var be=r(X,2),$e=a(be),Ie=r(a($e),2),te=a(Ie,!0);t(Ie),t($e);var pe=r($e,2);{var F=y=>{var Y=us(),x=r(a(Y),2),k=a(x);rr(k,{class:"w-4 h-4"});var N=r(k);t(x),t(Y),S(()=>{it(x,"href",`tel:${e(s),i(()=>e(s).cliente.telefone)??""}`),m(N,` ${e(s),i(()=>e(s).cliente.telefone)??""}`)}),o(y,Y)};u(pe,y=>{e(s),i(()=>e(s).cliente?.telefone)&&y(F)})}t(be),S(()=>m(te,(e(s),i(()=>e(s).cliente?.nome)))),o(w,G)},$$slots:{default:!0}});var Aa=r(ia,2);{var Ia=w=>{We(w,{padding:"p-6",children:(H,G)=>{var X=ps(),ge=g(X),be=a(ge);_a(be,{class:"w-5 h-5 text-brand-600"}),p(),t(ge);var $e=r(ge,2),Ie=a($e),te=a(Ie,!0);t(Ie);var pe=r(Ie,2),F=a(pe,!0);t(pe),t($e),S(y=>{m(te,y),m(F,(e(s),i(()=>e(s).tecnico.nome_completo)))},[()=>(e(s),i(()=>e(s).tecnico.nome_completo.charAt(0)))]),o(H,X)},$$slots:{default:!0}})};u(Aa,w=>{e(s),i(()=>e(s).tecnico)&&w(Ia)})}t(sa),t(Pt),t(kt),S((w,H)=>{m(M,(e(s),i(()=>e(s).titulo))),m(le,w),m(Oe,(e(s),i(()=>e(s).cliente?.nome))),m(Te,` ${H??""}`),Ye(St,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(A)==="overview"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Ye(Ct,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(A)==="services"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Ye(Nt,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(A)==="photos"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`),Ye(Ut,1,`flex-1 min-w-fit flex items-center justify-center gap-2 px-6 py-3 rounded-xl font-bold text-sm transition-all ${e(A)==="history"?"bg-white text-brand-600 shadow-sm":"text-surface-500 hover:text-surface-700"}`)},[()=>(e(s),i(()=>e(s).cliente?.nome?.charAt(0)||"?")),()=>(e(s),i(()=>b(e(s).created_at)))]),Q("click",St,()=>l(A,"overview")),Q("click",Ct,()=>l(A,"services")),Q("click",Nt,()=>l(A,"photos")),Q("click",Ut,()=>l(A,"history")),o(Je,mt)};u(_e,Je=>{e(s)&&Je(at)},!0)}o(v,$)};u(lt,v=>{e(Me)?v(Rt):v(qt,!1)})}t(Ze);var $t=r(Ze,2);{var Wt=v=>{var $=_s(),_e=a($),at=r(_e,2),Je=a(at);{let mt=ht(()=>(T(),i(()=>T()?.cargo==="admin"))),rt=ht(()=>(e(s),i(()=>({titulo:e(s).titulo,descricao:e(s).descricao_detalhada,valorTotal:e(s).valor_total||0,osDisplayNumber:e(s).sequential_id.toString(),clienteNome:e(s).cliente?.nome}))));Er(Je,{get isOpen(){return e(Ve)},get isAdmin(){return e(mt)},get initialData(){return e(rt)},$$events:{complete:ft,close:()=>l(Ve,!1)}})}t(at),t($),Q("click",_e,()=>l(Ve,!1)),o(v,$)};u($t,v=>{e(s)&&e(Ve)&&v(Wt)})}o(q,Xe),aa(),f()}export{Ys as component};
